This guide provides information about the installation of OpenSearch cluster on OpenShift/Kubernetes.

Topics covered in this section:

- [Prerequisites](#prerequisites)
- [Installation modes](#installation-modes)
- [Parameters](#parameters)
- [Deployment](#deployment)
  - [Manual Deployment](#manual-deployment)
  - [Deployment via DP Deployer Job](#deployment-via-dp-deployer-job)
  - [Deployment via Groovy Deployer Job](#deployment-via-groovy-deployer-job)
  - [Deployment with Restricted Rights](#deployment-with-restricted-rights)
  - [Automatic CRD Upgrade](#automatic-crd-upgrade)
- [Migration](#migration)
  - [Migration from OpenDistro Elasticsearch](#migration-from-opendistro-elasticsearch)
    - [Automatic Migration with Deploy Hob](#automatic-migration-with-deploy-job)
    - [Manual Migration Steps](#manual-migration-steps)
    - [Backup and Restore](#backup-and-restore)
    - [Migration from Elasticsearch 6.8 Service](#migrate-from-elasticsearch-68-service)
  - [DBaaS Adapter](#dbaas-adapter)
- [Custom Resource Definition](#custom-resource-definition)

# Prerequisites

Before you begin, ensure the following requirements are met:

* Kubernetes 1.16+ or OpenShift 4.3+
* `kubectl` 1.16+ or `oc` 4.3+ CLI
* Helm 3.0+
* All required CRDs are installed

The following Custom Resource Definitions should be installed to the cloud before the installation of OpenSearch:

* `OpenSearchService` - When you deploy with restricted rights or creating CRDs, it is disabled by the Deployer job. You also have to apply the CRD manually when performing the `Upgrade` operation for the version where the CRD is changed (tags usually contain this information). [CRDs folder](../../charts/helm/opensearch-service/crds).
* If `monitoring.enabled=true` and `monitoring.monitoringType=prometheus`, then `GrafanaDashboard`, `PrometheusRule`, and `ServiceMonitor` should be installed. You need to install the Monitoring Operator service before the OpenSearch installation.

**Important**: To create CRDs, you must have cloud admin rights. If the deployment user does not have the `cluster-admin` rights, you need to perform the steps described in the [Deployment with Restricted Rights](#deployment-with-restricted-rights) section before the installation.

**Note**: If you deploy OpenSearch service to Kubernetes version less than 1.16, you have to manually install CRD from `config/crd/old/netcracker.com_opensearchservices.yaml` and disable automatic CRD creation by Helm in the following way:

* Specify `--skip-crds` in `ADDITIONAL_OPTIONS` parameter of DP Deployer Job.
* Specify `DISABLE_CRD=true;` in `CUSTOM_PARAMS` parameter of Groovy Deployer Job.

Environment:

* `vm.max_map_count` should be `262144`. To do this, use the following command on all Kubernetes nodes, where OpenSearch is running:

   ```bash
   sysctl -w vm.max_map_count=262144
   ```

  This operation can be performed automatically during installation if `opensearch.sysctl.enabled` is `true`, but it requires the permission to run privileged containers for the cluster.
  **Pay attention**: running privileged containers is usually denied for public clouds.

* In case you deploy on *Openshift*, following annotations should be specified for the project:

  ```
  oc annotate --overwrite ns ${OS_PROJECT} openshift.io/sa.scc.supplemental-groups='1000/1000'
  oc annotate --overwrite ns ${OS_PROJECT} openshift.io/sa.scc.uid-range='1000/1000'
  ```

* If you use predefined `hostPath` persistent volumes, set the appropriate `UID` and `GID` on the `hostPath` directories and rule for SELinux:

   ```
   chown -R 1000:1000 /var/lib/origin/openshift.local.volumes/<pv-name>
   chcon -R unconfined_u:object_r:container_file_t:s0 /var/lib/origin/openshift.local.volumes/<pv-name>
   ```

  **Note**: `1000` UID is the default value. If user is different from `1000`, you need to annotate project with corresponding user.

  These labels are generated automatically when you use the `pv-creator` utility to create them.
  You can specify the `persistence.persistentVolumes` parameter for `master` and `data` to use pre-created persistent volumes with other naming rules.

* If you install OpenSearch service on OpenDistro Elasticsearch service you need to execute steps from [Migration from OpenDistro Elasticsearch](#migration-from-opendistro-elasticsearch).

## Common Solution Prerequisites

* Persistent volumes should be created for master nodes in joint mode and for master and data nodes in separate mode.

### Hardware Requirements

The following HWE is provided as an example to estimate the project needs.

| Component                    | Hardware                                           | Minimal                                        | Recommended                                             |
|------------------------------|----------------------------------------------------|------------------------------------------------|---------------------------------------------------------|
| Opensearch                   | CPU <br> RAM <br> Java heap <br> HDD <br> NFS (S3) | 400m <br> 2 Gb <br> 1 Gb <br> 10 Gb <br> 10 Gb | 2 <br> 8 Gb <br> 4 Gb <br> 1.2*DB size <br> 1.2*DB size |
| Opensearch Monitoring        | CPU <br> RAM                                       | 200m <br> 256 Mb                               | 200m <br> 256 Mb                                        |
| Opensearch Curator           | CPU <br> RAM                                       | 200m <br> 256 Mb                               | 200m <br> 256 Mb                                        |
| Opensearch statusProvisioner | CPU <br> RAM                                       | 200m <br> 256 Mb                               | 200m <br> 256 Mb                                        |
| DBaaS Opensearch Adapter     | CPU <br> RAM                                       | 200m <br> 32 Mb                                | 400m <br> 64 Mb                                         |
| DBaaS Elasticsearch Adapter  | CPU <br> RAM                                       | 200m <br> 32 Mb                                | 400m <br> 64 Mb                                         |

  **Note**: Provided HWE for **Opensearch** component are for the single node. In case you have multiple instances, you have to provide the same resources for each node.  

# Installation modes

## Joint

The OpenSearch `joint` installation mode implies that each node has `master`, `data` and `client` roles.

## Separate

The OpenSearch `separate` installation mode implies that each node either has one of the `master`,
`data` and `client` roles or a combination of the two. For example, OpenSearch installation has
3 `master` nodes, 2 `data` nodes and 2 `client` nodes, or 3 nodes with `data` and `master` roles and
2 `client` nodes.

If `data` and `master` nodes are separated, it is important to specify persistent storages not only
for `data` nodes but also for `master` nodes.
The size of persistent storage for `master` node should be small. For example, `1Gi`.

## Deploy with Arbiter

OpenSearch `arbiter` nodes installed to Kubernetes nodes different from `master` provide stability of OpenSearch cluster if `master` nodes went down.
**Important**: `arbiter` nodes do not store any indices data, but still need PV to work, the size of persistent storage for `arbiter` node should be small.
You can find example of the base parameters for the installation in [samples](#samples) section.

## Deploy with Managed External OpenSearch

OpenSearch Service allows you to deploy OpenSearch side services (DBaaS Adapter, Monitoring and Curator) without deploying OpenSearch, 
using external URL.
You can find examples and details in [Amazon OpenSearch](./amazon/README.md).

# Parameters

The section lists the configurable parameters of the OpenSearch chart and their default values.

The `nameOverride` parameter specifies the name for OpnSearch resources if `fullnameOverride` 


nameOverride: "opensearch"
fullnameOverride: "opensearch"

| Parameter                                                                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Default                                                                                                                                    | Required                                                                                         |
|----------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| `fullnameOverride`                                                         | The base name for all OpenSearch resources (Services, StatefulSets, etc)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `"opensearch"`                                                                                                                             | false                                                                                            |
| `global.clusterName`                                                       | Name of OpenSearch cluster                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `"opensearch"`                                                                                                                             | false                                                                                            |
| `global.psp.create`                                                        | Create and use `podsecuritypolicy` resources                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `"true"`                                                                                                                                   | false                                                                                            |
| `global.rbac.enabled`                                                      | Create and use `rbac` resources                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"true"`                                                                                                                                   | false                                                                                            |
| `global.imagePullSecrets`                                                  | Global Docker registry secret names as an array                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `[]` (does not add image pull secrets to deployed pods)                                                                                    | false                                                                                            |
| `global.disasterRecovery.image`                                            | The Disaster Recovery OpenSearch operator container image.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `artifactorycn.netcracker.com:17008/product/prod.platform.streaming_disaster-recovery-daemon:master_latest`                                | false                                                                                            |
| `global.disasterRecovery.tls.enabled`                                      | Specifies whether TLS is enabled for Disaster Recovery Daemon. This parameter is taken into account only if `global.tls.enabled` parameter is set to `true`. For more information about TLS, see [Encrypted Access](/documentation/installation-guide/encrypted-access/README.md).                                                                                                                                                                                                                                                                                | `true`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.tls.secretName`                                   | Specifies the secret that contains TLS certificates. It is required if TLS for Disaster Recovery Daemon is enabled and certificates generation is disabled.                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.tls.cipherSuites`                                 | Specifies the list of cipher suites that are used to secure network connection using TLS or SSL network protocol. If this parameter is not specified, cipher suites are taken from `global.tls.cipherSuites` parameter.                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.tls.subjectAlternativeName.additionalDnsNames`    | Specifies the list of additional DNS names to be added to the `Subject Alternative Name` field of TLS certificate.                                                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.tls.subjectAlternativeName.additionalIpAddresses` | Specifies the list of additional IP addresses to be added to the `Subject Alternative Name` field of TLS certificate.                                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.httpAuth.enabled`                                 | This parameter specifies if authentication should be enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.httpAuth.smNamespace`                             | The name of Kubernetes Namespace from which site manager API calls will be done.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `site-manager`                                                                                                                             | false                                                                                            |
| `global.disasterRecovery.httpAuth.smServiceAccountName`                    | The name of Kubernetes Service Account under which site manager API calls will be done.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `sm-auth-sa`                                                                                                                               | false                                                                                            |
| `global.disasterRecovery.httpAuth.restrictedEnvironment`                   | If the parameter is `true` the `system:auth-delegator` cluster role will be bound to OpenSearch operator service account. The cluster role will be not bound if the disaster recovery mode is disabled, or the disaster recovery server authentication is disabled.                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                    | false                                                                                            |
| `global.disasterRecovery.mode`                                             | Specifies whether the current side is active during service installation in Disaster Recovery mode. If you do not specify this parameter, the service is deployed in a regular mode, not Disaster Recovery mode. The possible values are `active`,`standby`,`disabled`                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       | true if you need `Disaster Recovery` mode                                                        |
| `global.disasterRecovery.indicesPattern`                                   | The regular expression which will be used to find OpenSearch indices for cross cluster replication.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `.*`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.remoteCluster`                                    | The URL of "active" OpenSearch service. For example, `opensearch.opensearch-service:9300` where `opensearch` is Kubernetes service, `opensearch-service` is Kubernetes namespace, `9300` is transport port.                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | true if you need `Disaster Recovery` mode                                                        |
| `global.disasterRecovery.siteManagerEnabled`                               | Enables creation of a Kubernetes Custom Resource for `SiteManager`. This property is used for inner developers purposes.                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.replicationWatcherEnabled`                        | Enables Replication Watcher feature which periodically checks that replication on standby side is performing correctly and if not - restart replication from start point.                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.replicationWatcherIntervalSeconds`                | Specifies the interval (in seconds) to check replication status by Replication Watcher.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `30`                                                                                                                                       | false                                                                                            |
| `global.disasterRecovery.resources.requests.cpu`                           | The minimum number of CPUs the disaster recovery daemon container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `25m`                                                                                                                                      | false                                                                                            |
| `global.disasterRecovery.resources.requests.memory`                        | The minimum amount of memory the disaster recovery daemon container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `32Mi`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.resources.limits.cpu`                             | The maximum number of CPUs the disaster recovery daemon container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `100m`                                                                                                                                     | false                                                                                            |
| `global.disasterRecovery.resources.limits.memory`                          | The maximum  amount of memory the disaster recovery daemon container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `128Mi`                                                                                                                                    | false                                                                                            |
| `global.disasterRecovery.afterServices`                                    | The list of `SiteManager` names for services after which the OpenSearch service switchover is to be run.                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       | false                                                                                            |
| `global.externalOpensearch.enabled`                                        | Specifies whether to use external OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `false`                                                                                                                                    | false                                                                                            |
| `global.externalOpensearch.url`                                            | Specifies the url of external OpenSearch. Should be presented with protocol. For example, `https://external-opensearch.eks.amazon.com`.                                                                                                                                                                                                                                                                                                                                                                                                                           | `""`                                                                                                                                       | true if `global.externalOpensearch.enabled: true`                                                |
| `global.externalOpensearch.username`                                       | Specifies the username of external OpenSearch user to connect. User should have admin rights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | true if `global.externalOpensearch.enabled: true`                                                |
| `global.externalOpensearch.password`                                       | Specifies the password of external OpenSearch user to connect. User should have admin rights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | true if `global.externalOpensearch.enabled: true`                                                |
| `global.externalOpensearch.nodesCount`                                     | Specifies the total number of external OpenSearch nodes (data and master).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `3`                                                                                                                                        | true if `global.externalOpensearch.enabled: true`                                                |
| `global.externalOpensearch.dataNodesCount`                                 | Specifies the number of external OpenSearch data nodes. If master and data nodes are the same, the same value should be used.                                                                                                                                                                                                                                                                                                                                                                                                                                     | `3`                                                                                                                                        | true if `global.externalOpensearch.enabled: true`                                                |
| `global.tls.enabled`                                                       | Specifies whether TLS is enabled for all OpenSearch services. For more information about TLS, see [Encrypted Access](/documentation/installation-guide/encrypted-access/README.md).                                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                    | false                                                                                            |
| `global.tls.cipherSuites`                                                  | Specifies the list of cipher suites that are used to secure network connection using TLS or SSL network protocol.                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                                                                                                                                       | false                                                                                            |
| `global.tls.generateCerts.enabled`                                         | Specifies whether TLS certificates are generated. This parameter is taken into account only if `global.tls.enabled` parameter is set to `true`.                                                                                                                                                                                                                                                                                                                                                                                                                   | `true`                                                                                                                                     | false                                                                                            |
| `global.tls.generateCerts.certProvider`                                    | Specifies provider used for TLS certificates generation. The possible values are `cert-manager` and `dev`.                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `cert-manager`                                                                                                                             | false                                                                                            |
| `global.tls.generateCerts.durationDays`                                    | Specifies TLS certificates validity period in days.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `365`                                                                                                                                      | false                                                                                            |
| `global.tls.generateCerts.clusterIssuerName`                               | Specifies name of `ClusterIssuer` resource. If the parameter is not set or empty, `Issuer` resource is created in current Kubernetes namespace. It is used when `global.tls.generateCerts.certProvider` parameter is set to `cert-manager`. **Important**: This parameter must be set for production environment.                                                                                                                                                                                                                                                 | `""`                                                                                                                                       | false                                                                                            |
| `global.velero.preHookBackupEnabled`                                       | Specifies whether Velero backup pre-hook with OpenSearch flush command is enabled. If parameter is set to `true`, OpenSearch initiates data flushing to store all unflushed data on disk before Velero backup procedure. For more information about Velero backup hooks, see [Backup Hooks](https://velero.io/docs/v1.9/backup-hooks/).                                                                                                                                                                                                                           | `true`                                                                                                                                     | false                                                                                            |
| `global.customLabels`                                                      | Allows specifying custom labels for all pods which are related to the OpenSearch Service. These labels can be overridden by local custom labels.                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.enabled`                                                       | Enable the installation of Dashboards                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `true`                                                                                                                                     | false                                                                                            |
| `dashboards.dockerImage`                                                   | The docker image of Dashboards.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `artifactorycn.netcracker.com:17064/opensearchproject/opensearch-dashboards:1.3.6`                                                         | false                                                                                            |
| `dashboards.imagePullPolicy`                                               | Dashboards container image pull policy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `Always`                                                                                                                                   | false                                                                                            |
| `dashboards.replicas`                                                      | Number of Dashboards instances to deploy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `1`                                                                                                                                        | false                                                                                            |
| `dashboards.port`                                                          | Internal Port for service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `5601`                                                                                                                                     | false                                                                                            |
| `dashboards.externalPort`                                                  | External Port for service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `443`                                                                                                                                      | false                                                                                            |
| `dashboards.resources`                                                     | Dashboards pod resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.opensearchAccount.secret`                                      | The name of the secret with the Dashboards server user as configured in your dashboards.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `dashboards.opensearchAccount.keyPassphrase.enabled`                       | Enable mounting in key passphrase for the `opensearchAccount`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `false`                                                                                                                                    | false                                                                                            |
| `dashboards.configDirectory`                                               | Location of where to mount in Dashboards specific configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"/usr/share/opensearch/config"`                                                                                                           | false                                                                                            |
| `dashboards.certsDirectory`                                                | Location of where to mount in Dashboards certs configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `"/usr/share/opensearch/certs"`                                                                                                            | false                                                                                            |
| `dashboards.ingress.enabled`                                               | Enable Dashboards Ingress                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    | false                                                                                            |
| `dashboards.ingress.annotations`                                           | Dashboards Ingress annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.ingress.hosts`                                                 | Dashboards Ingress Hostnames                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       | true if `dashboards.ingress.enabled: true`                                                       |
| `dashboards.ingress.tls`                                                   | Dashboards Ingress TLS configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.ingress.labels`                                                | Dashboards Ingress labels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.ingress.path`                                                  | Dashboards Ingress paths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.service.type`                                                  | The type of Dashboards service.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `ClusterIP`                                                                                                                                | false                                                                                            |
| `dashboards.service.annotations`                                           | The annotations that should be specified on Dashboards service.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.config`                                                        | Dashboards Configuration (`dashboards.yml`)        fv                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.nodeSelector`                                                  | Define which Nodes the Pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.affinity`                                                      | The affinity scheduling rules for Dashboards.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.podAnnotations`                                                | Dashboards pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       | false                                                                                            |
| `dashboards.securityContext`                                               | Dashboards security context. Should be filed as `runAsUser: 1000` for non-root privileges environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.tolerations`                                                   | If specified, the pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.serviceAccount.create`                                         | Create a default service account for Dashboards to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     | false                                                                                            |
| `dashboards.serviceAccount.name`                                           | Name for Dashboards service account                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | false                                                                                            |
| `dashboards.extraEnvs`                                                     | Extra environments variables to be passed to Dashboards                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.extraVolumes`                                                  | Array of extra volumes to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.extraVolumeMounts`                                             | Array of extra volume mounts to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.extraInitContainers`                                           | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.extraContainers`                                               | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.readinessProbe`                                                | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.livenessProbe`                                                 | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `dashboards.startupProbe`                                                  | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `operator.dockerImage`                                                     | The docker image of OpenSearch Service Operator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_opensearch-service:master_latest`                                   | false                                                                                            |
| `operator.replicas`                                                        | The number of OpenSearch Service Operator pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `1`                                                                                                                                        | false                                                                                            |
| `operator.tolerations`                                                     | The list of toleration policies for OpenSearch Service Operator pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `operator.affinity`                                                        | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `operator.customLabels`                                                    | Allows specifying custom labels for the OpenSearch operator pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `operator.resources.requests.cpu`                                          | The minimum number of CPUs the operator container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `25m`                                                                                                                                      | false                                                                                            |
| `operator.resources.requests.memory`                                       | The minimum amount of memory the operator container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `128Mi`                                                                                                                                    | false                                                                                            |
| `operator.resources.limits.cpu`                                            | The maximum number of CPUs the operator container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `100m`                                                                                                                                     | false                                                                                            |
| `operator.resources.limits.memory`                                         | The maximum amount of memory the operator container should use use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `128Mi`                                                                                                                                    | false                                                                                            |
| `opensearch.discoveryOverride`                                             | For hot/warm architectures. Allows second aliased deployment to find cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.compatibilityModeEnabled`                                             | For enabling compatibility mode.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `true`                                                                                                                                       | false                                                                                            |
| `opensearch.fixmount.enabled`                                              | Enable initContainer to fix mount permissions. Not required if setting a fsGroup via securityContext                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.sys_chroot.enabled`                                            | Enable giving OpenSearch containers the "SYS_CHROOT" capability.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.sysctl.enabled`                                                | Enable initContainer to set sysctl "vm.max_map_count"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.securityConfig.enabled`                                        | Use custom [security configs](https://github.com/opensearch-project/security/tree/main/securityconfig).                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `"true"`                                                                                                                                   | false                                                                                            |
| `opensearch.securityConfig.authc.basic.username`                           | Username for default admin OpenSearch user.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | true                                                                                             |
| `opensearch.securityConfig.authc.basic.password`                           | Password for default admin OpenSearch user.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | true                                                                                             |
| `opensearch.securityConfig.authc.oidc.openid_connect_url`                  | Url of OpenID Connect Identity Provider's well known endpoint. If specified the openid connect authentication is enabled. For example, `"http://idp:8080/.well-known/openid-configuration"`                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.authc.oidc.subject_key`                         | The key in the JSON payload that stores the user’s name. If not defined, the subject registered claim is used.                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `"preferred_username"`                                                                                                                     | false                                                                                            |
| `opensearch.securityConfig.authc.oidc.roles_key`                           | The key in the JSON payload that stores the user’s roles. The value of this key must be a comma-separated list of roles. Required only if you want to use roles in the JWT.                                                                                                                                                                                                                                                                                                                                                                                       | `"preferred_username"`                                                                                                                     | false                                                                                            |
| `opensearch.securityConfig.path`                                           | Path to security config files                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `"/usr/share/opensearch/plugins/opensearch-security/securityconfig"`                                                                       | false                                                                                            |
| `opensearch.securityConfig.actionGroupsSecret`                             | Name of secret with [action_groups.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/action_groups.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.configSecret`                                   | Name of secret with [config.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/config.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.internalUsersSecret`                            | Name of secret with [internal_users.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/internal_users.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.rolesSecret`                                    | Name of secret with [roles.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/roles.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.rolesMappingSecret`                             | Name of secret with [roles_mapping.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/roles_mapping.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityConfig.tenantsSecret`                                  | Name of secret with [tenants.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/tenants.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.securityContextCustom`                                         | securityContext for the OpenSearch pods                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.enabled`                                                   | Specifies whether TLS is enabled for REST layer of OpenSearch. This parameter is taken into account only if `global.tls.enabled` parameter is set to `true`. For more information about TLS, see [Encrypted Access](/documentation/installation-guide/encrypted-access/README.md).                                                                                                                                                                                                                                                                                | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.tls.cipherSuites`                                              | Specifies the list of cipher suites that are used to secure network connection using TLS or SSL network protocol. If this parameter is not specified, cipher suites are taken from `global.tls.cipherSuites` parameter.                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.generateCerts.enabled`                                     | Specifies whether OpenSearch certificates are generated. This parameter is taken into account only if `global.tls.generateCerts.enabled` parameter is set to `true`.                                                                                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.tls.subjectAlternativeName.additionalDnsNames`                 | Specifies the list of additional DNS names to be added to the `Subject Alternative Name` field of REST TLS certificate for OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.subjectAlternativeName.additionalIpAddresses`              | Specifies the list of additional IP addresses to be added to the `Subject Alternative Name` field of REST TLS certificate for OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.transport.existingCertSecret`                              | Name of secret that contains the transport certs. If the value is not specified, the secret with transport certificates named `<fullname>-transport-certs` is created, where `<fullname>` is OpenSearch full name                                                                                                                                                                                                                                                                                                                                                 | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.transport.existingCertSecretCertSubPath`                   | Subpath of elastic transport cert secret. This parameter is not taken into account if `opensearch.tls.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                            | `"tls.crt"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.transport.existingCertSecretKeySubPath`                    | Subpath of elastic transport key secret. This parameter is not taken into account if `opensearch.tls.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                             | `"tls.key"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.transport.existingCertSecretRootCASubPath`                 | Subpath of elastic transport root ca secret. This parameter is not taken into account if `opensearch.tls.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                         | `"ca.crt"`                                                                                                                                 | false                                                                                            |
| `opensearch.tls.rest.existingCertSecret`                                   | Name of secret that contains the OpenSearch REST certs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.rest.existingCertSecretCertSubPath`                        | Subpath of elastic rest cert secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"tls.crt"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.rest.existingCertSecretKeySubPath`                         | Subpath of elastic rest key secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `"tls.key"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.rest.existingCertSecretRootCASubPath`                      | Subpath of elastic rest root ca secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"ca.crt"`                                                                                                                                 | false                                                                                            |
| `opensearch.tls.admin.existingCertSecret`                                  | Name of secret that contains the admin users OpenSearch certs. If the value is not specified, the secret with admin certificates named `<fullname>-admin-certs` is created, where `<fullname>` is OpenSearch full name.                                                                                                                                                                                                                                                                                                                                           | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.tls.admin.existingCertSecretCertSubPath`                       | Subpath of elastic admin cert secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"tls.crt"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.admin.existingCertSecretKeySubPath`                        | Subpath of elastic admin key secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"tls.key"`                                                                                                                                | false                                                                                            |
| `opensearch.tls.admin.existingCertSecretRootCASubPath`                     | Subpath of elastic admin root ca secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `"ca.crt"`                                                                                                                                 | false                                                                                            |
| `opensearch.master.enabled`                                                | Enables the OpenSearch Master                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.master.replicas`                                               | Number of OpenSearch masters to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `3`                                                                                                                                        | false                                                                                            |
| `opensearch.master.resources`                                              | OpenSearch masters resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.master.javaOpts`                                               | OpenSearch masters configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms718m -Xmx718m"`                                                                                                                      | false                                                                                            |
| `opensearch.master.podDisruptionBudget.enabled`                            | If true, create a disruption budget for OpenSearch master                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.master.podDisruptionBudget.minAvailable`                       | Minimum number / percentage of pods that [should remain scheduled](https://kubernetes.io/docs/tasks/run-application/configure-pdb/#think-about-how-your-application-reacts-to-disruptions)                                                                                                                                                                                                                                                                                                                                                                        | `1`                                                                                                                                        | false                                                                                            |
| `opensearch.master.podDisruptionBudget.maxUnavailable`                     | Maximum number / percentage of pods that [may be unscheduled](https://kubernetes.io/docs/tasks/run-application/configure-pdb/#think-about-how-your-application-reacts-to-disruptions)                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.master.tolerations`                                            | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.nodeSelector`                                           | Define which Nodes the master pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.master.affinity`                                               | The affinity scheduling rules for OpenSearch masters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.master.podAnnotations`                                         | OpenSearch master pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.master.livenessProbe`                                          | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.readinessProbe`                                         | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.startupProbe`                                           | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.updateStrategy`                                         | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the master `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                           | `RollingUpdate`                                                                                                                            | false                                                                                            |
| `opensearch.master.persistence.enabled`                                    | OpenSearch master enable persistent storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.master.persistence.existingClaim`                              | OpenSearch master persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | disabled by default, see `values.yaml`                                                                                                     | false                                                                                            |
| `opensearch.master.persistence.subPath`                                    | OpenSearch master persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.master.persistence.storageClass`                               | OpenSearch master storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | see `values.yaml` for defaults                                                                                                             | true if `opensearch.master.persistence.enabled: true` and `storage class` need to be used        |
| `opensearch.master.persistence.persistentVolumes`                          | The list of OpenSearch master predefined persistent volumes. The number of PVs should be equal to number of master replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                       | [ ]                                                                                                                                        | true if `opensearch.master.persistence.enabled: true` and `hostpath` PV need to be used          |
| `opensearch.master.persistence.nodes`                                      | The list of Kubernetes node names to assign OpenSearch master pods. The number of nodes should be equal to number of master replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                      | [ ]                                                                                                                                        | true if `opensearch.master.persistence.persistentVolumes` are specified                          |
| `opensearch.master.persistence.accessModes`                                | OpenSearch master persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `- ReadWriteOnce`                                                                                                                          | false                                                                                            |
| `opensearch.master.persistence.size`                                       | OpenSearch master persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `"5Gi"`                                                                                                                                    | false                                                                                            |
| `opensearch.master.persistence.annotations`                                | OpenSearch master persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.master.extraInitContainers`                                    | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.extraContainers`                                        | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.master.customLabels`                                           | Allows specifying custom labels for the OpenSearch master pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.enabled`                                               | Enables the OpenSearch arbiter. OpenSearch arbiter pods installed to different kubernetes node than master provide OpenSearch cluster stability if master nodes went down. **Important** arbiter pods do not store any indices data.                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.arbiter.replicas`                                              | Number of OpenSearch arbiter to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `1`                                                                                                                                        | false                                                                                            |
| `opensearch.arbiter.resources`                                             | OpenSearch arbiter resource requests and limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.javaOpts`                                              | OpenSearch arbiter configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms718m -Xmx718m"`                                                                                                                      | false                                                                                            |
| `opensearch.arbiter.tolerations`                                           | The list of toleration policies for OpenSearch arbiter pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.nodeSelector`                                          | Define which Nodes the arbiter pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.affinity`                                              | The affinity scheduling rules for OpenSearch arbiter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.podAnnotations`                                        | OpenSearch arbiter pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.livenessProbe`                                         | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.readinessProbe`                                        | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.startupProbe`                                          | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.updateStrategy`                                        | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the arbiter `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                          | `RollingUpdate`                                                                                                                            | false                                                                                            |
| `opensearch.arbiter.persistence.enabled`                                   | Enables persistent storage for OpenSearch arbiter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.arbiter.persistence.existingClaim`                             | OpenSearch arbiter persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.persistence.subPath`                                   | OpenSearch arbiter persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.persistence.storageClass`                              | OpenSearch arbiter storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | true if `opensearch.arbiter.persistence.enabled: true` and `storage class` need to be used       |
| `opensearch.arbiter.persistence.persistentVolumes`                         | The list of OpenSearch arbiter predefined persistent volumes. The number of PVs should be equal to number of master replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                      | [ ]                                                                                                                                        | true if `opensearch.arbiter.persistence.enabled: true` and `hostpath` PV need to be used         |
| `opensearch.arbiter.persistence.nodes`                                     | The list of Kubernetes node names to assign OpenSearch arbiter pods. The number of nodes should be equal to number of master replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                     | [ ]                                                                                                                                        | true if `opensearch.arbiter.persistence.persistentVolumes` are specified                         |
| `opensearch.arbiter.persistence.accessModes`                               | OpenSearch arbiter persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `- ReadWriteOnce`                                                                                                                          | false                                                                                            |
| `opensearch.arbiter.persistence.size`                                      | OpenSearch arbiter persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"5Gi"`                                                                                                                                    | false                                                                                            |
| `opensearch.arbiter.persistence.annotations`                               | OpenSearch arbiter persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.extraInitContainers`                                   | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.arbiter.extraContainers`                                       | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                            | false                                                                                            |
| `opensearch.arbiter.customLabels`                                          | Allows specifying custom labels for the OpenSearch arbiter pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.enabled`                                                | Enables the OpenSearch Client/Ingester                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.client.dedicatedPod.enabled`                                   | Enables dedicated deployment for client/ingest. Otherwise master nodes as client/ingest                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.client.replicas`                                               | Number of OpenSearch clients to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `3`                                                                                                                                        | false                                                                                            |
| `opensearch.client.affinity`                                               | The affinity scheduling rules for OpenSearch clients.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.resources`                                              | OpenSearch clients resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.javaOpts`                                               | OpenSearch clients configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms512m -Xmx512m"`                                                                                                                      | false                                                                                            |
| `opensearch.client.service.type`                                           | OpenSearch clients service type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `ClusterIP`                                                                                                                                | false                                                                                            |
| `opensearch.client.service.annotations`                                    | OpenSearch clients service annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.ingress.enabled`                                        | Enable OpenSearch clients Ingress                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.client.ingress.annotations`                                    | OpenSearch clients Ingress annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.ingress.hosts`                                          | OpenSearch clients Ingress Hostnames                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | true if `opensearch.client.ingress.enabled: true`                                                |
| `opensearch.client.ingress.tls`                                            | OpenSearch clients Ingress TLS configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.client.ingress.labels`                                         | OpenSearch clients Ingress labels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.ingress.path`                                           | OpenSearch clients Ingress path                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `/`                                                                                                                                        | false                                                                                            |
| `opensearch.client.livenessProbe`                                          | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.client.readinessProbe`                                         | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.client.startupProbe`                                           | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.client.podDisruptionBudget.enabled`                            | If true, create a disruption budget for OpenSearch client                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.client.podDisruptionBudget.minAvailable`                       | Minimum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                                                                                                                                        | false                                                                                            |
| `opensearch.client.podDisruptionBudget.maxUnavailable`                     | Maximum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.client.tolerations`                                            | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.client.nodeSelector`                                           | Define which Nodes the client pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.podAnnotations`                                         | OpenSearch client pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.client.customLabels`                                           | Allows specifying custom labels for the OpenSearch client pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.enabled`                                                  | Enables the OpenSearch Data Node                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.data.dedicatedPod.enabled`                                     | Enables dedicated `StatefulSet` for data. Otherwise master nodes as data storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.data.replicas`                                                 | Number of OpenSearch data nodes to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `3`                                                                                                                                        | false                                                                                            |
| `opensearch.data.affinity`                                                 | The affinity scheduling rules for OpenSearch data pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.resources`                                                | OpenSearch data resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.javaOpts`                                                 | OpenSearch data configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"-Xms718m -Xmx718m"`                                                                                                                      | false                                                                                            |
| `opensearch.data.persistence.enabled`                                      | OpenSearch data enable persistent storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.data.persistence.existingClaim`                                | OpenSearch data persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | disabled by default, see `values.yaml`                                                                                                     | false                                                                                            |
| `opensearch.data.persistence.subPath`                                      | OpenSearch data persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.data.persistence.storageClass`                                 | OpenSearch data storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | see `values.yaml` for defaults                                                                                                             | true if `opensearch.data.persistence.enabled: true` and `storage class` need to be used          |
| `opensearch.data.persistence.persistentVolumes`                            | The list of OpenSearch data predefined persistent volumes. The number of PVs should be equal to number of data replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                           | [ ]                                                                                                                                        | true if `opensearch.data.persistence.enabled: true` and `hostpath` PV need to be used            |
| `opensearch.data.persistence.nodes`                                        | The list of Kubernetes node names to assign OpenSearch data pods. The number of nodes should be equal to number of data replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                          | [ ]                                                                                                                                        | true if `opensearch.data.persistence.persistentVolumes` are specified                            |
| `opensearch.data.persistence.accessModes`                                  | OpenSearch data persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `- ReadWriteOnce`                                                                                                                          | false                                                                                            |
| `opensearch.data.persistence.size`                                         | OpenSearch data persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `"5Gi"`                                                                                                                                    | false                                                                                            |
| `opensearch.data.persistence.annotations`                                  | OpenSearch data persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.podDisruptionBudget.enabled`                              | If true, create a disruption budget for OpenSearch data node                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.data.podDisruptionBudget.minAvailable`                         | Minimum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                                                                                                                                        | false                                                                                            |
| `opensearch.data.podDisruptionBudget.maxUnavailable`                       | Maximum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.data.tolerations`                                              | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.data.nodeSelector`                                             | Define which Nodes the data pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.podAnnotations`                                           | OpenSearch data pod annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.data.livenessProbe`                                            | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.data.readinessProbe`                                           | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.data.startupProbe`                                             | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.data.updateStrategy`                                           | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the data `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                             | `RollingUpdate`                                                                                                                            | false                                                                                            |
| `opensearch.data.customLabels`                                             | Allows specifying custom labels for the OpenSearch data pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.config`                                                        | OpenSearch Configuration (`opensearch.yml`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       | false                                                                                            |
| `opensearch.loggingConfig`                                                 | OpenSearch Logging Configuration (`logging.yml`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | see `values.yaml` for defaults                                                                                                             | false                                                                                            |
| `opensearch.log4jConfig`                                                   | OpenSearch log4j Configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.transportKeyPassphrase.enabled`                                | OpenSearch transport key passphrase required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.transportKeyPassphrase.passPhrase`                             | OpenSearch transport key passphrase                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.sslKeyPassphrase.enabled`                                      | OpenSearch ssl key passphrase required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.sslKeyPassphrase.passPhrase`                                   | OpenSearch ssl key passphrase                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.dockerImage`                                                   | The docker image of OpenSearch                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-opensearch:master_latest`                                    | false                                                                                            |
| `opensearch.imagePullPolicy`                                               | OpenSearch container image pull policy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `Always`                                                                                                                                   | false                                                                                            |
| `opensearch.initContainer.dockerImage`                                     | The docker image of OpenSearch init container.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `artifactorycn.netcracker.com:17010/busybox:1.29.3`                                                                                        | false                                                                                            |
| `opensearch.serviceAccount.create`                                         | Create a default service account for OpenSearch to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     | false                                                                                            |
| `opensearch.serviceAccount.name`                                           | Name for OpenSearch service account                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.configDirectory`                                               | Location of OpenSearch configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"/usr/share/opensearch/config"`                                                                                                           | false                                                                                            |
| `opensearch.maxMapCount`                                                   | OpenSearch max_map_count                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `262144`                                                                                                                                   | false                                                                                            |
| `opensearch.extraEnvs`                                                     | Extra environments variables to be passed to OpenSearch services                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.extraVolumes`                                                  | Array of extra volumes to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.extraVolumeMounts`                                             | Array of extra volume mounts to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.extraInitContainers`                                           | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       | false                                                                                            |
| `opensearch.snapshots.enabled`                                             | Create and mount persistent volume claim for snapshot repository.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.snapshots.persistentVolume`                                    | The name of RWX Persistent Volume to store snapshots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       | true if `opensearch.snapshots.enabled: true` and there is predefined RWX persistent volume       |
| `opensearch.snapshots.storageClass`                                        | The name of shared storage class to store snapshots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `""`                                                                                                                                       | true if `opensearch.snapshots.enabled: true` and `shared storage class` need to be used          |
| `opensearch.snapshots.persistentVolumeClaim`                               | The name of RWX Persistent Volume Claim to store snapshots. If specified then no new PVC are created, OpenSearch pods use specified PVC.                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       | true if `opensearch.snapshots.enabled: true` and there is predefined RWX persistent volume claim |
| `opensearch.snapshots.size`                                                | Snapshot volume size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"5Gi"`                                                                                                                                    | false                                                                                            |
| `opensearch.snapshots.s3.enabled`                                          | Enables saving OpenSearch backups to S3 storage. OpenSearch supports the following S3 providers: AWS S3, MinIO. Google Cloud Storage is not supported. Other S3 providers may work, but are not covered by the OpenSearch test suite. **Note** Parameters `snapshots.persistentVolume` and `snapshots.storageClass` are not needed if S3 storage is enabled.                                                                                                                                                                                                      | `false`                                                                                                                                    | false                                                                                            |
| `opensearch.snapshots.s3.pathStyleAccess`                                  | Enables path style access for S3 storage.  **Note**: For Minio this parameter value must be `true`.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                    | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.url`                                              | The URL of a S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.bucket`                                           | The bucket in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.basePath`                                         | The base path in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `"`                                                                                                                                        | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.region`                                           | The region in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.keyId`                                            | The key ID for the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | true if `opefvnsearch.snapshots.s3.enabled: true`                                                |
| `opensearch.snapshots.s3.keySecret`                                        | The key secret for the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       | true if `opensearch.snapshots.s3.enabled: true`                                                  |
| `opensearch.snapshots.s3.gcs.secretName`                                   | Name of pre-created secret with json key to GCS bucket. The key must be created following this guide: [Google Cloud Storage for Snapshots](#google-cloud-storage-for-snapshots).                                                                                                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `opensearch.snapshots.s3.gcs.secretKey`                                    | The key of value with GCS json key inside secret.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `""`                                                                                                                                       | true if there is `opensearch.snapshots.s3.gcs.secretName`                                        |
| `opensearch.tlsInit.resources.requests.cpu`                                | The minimum number of CPUs the job for TLS initialization should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `25m`                                                                                                                                      | false                                                                                            |
| `opensearch.tlsInit.resources.requests.memory`                             | The minimum amount of memory the tls-init job should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `128Mi`                                                                                                                                    | false                                                                                            |
| `opensearch.tlsInit.resources.limits.cpu`                                  | The maximum number of CPUs the tls-init job should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `100m`                                                                                                                                     | false                                                                                            |
| `opensearch.tlsInit.resources.limits.memory`                               | The maximum  amount of memory the tls-init job should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `128Mi`                                                                                                                                    | false                                                                                            |
| `podScheduler.enabled`                                                     | Deploy custom kubernetes pod scheduler pod to assign OpenSearch pods to nodes with `hostPath` PV. Must be enabled if `persistentVolumes` and `nodes` are specified for master or data persistence.                                                                                                                                                                                                                                                                                                                                                                | `true`                                                                                                                                     | false                                                                                            |
| `podScheduler.dockerImage`                                                 | The docker image for Pod Scheduler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `artifactorycn.netcracker.com:17014/product/prod.platform.streaming_docker-kubectl:0.0.1_20221027-081543`                                  | false                                                                                            |
| `podScheduler.affinity`                                                    | Pod Scheduler affinity rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       | false                                                                                            |
| `podScheduler.nodeSelector`                                                | Pod Scheduler node selector                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       | false                                                                                            |
| `podScheduler.resources`                                                   | Pod Scheduler resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `{}`                                                                                                                                       | false                                                                                            |
| `podScheduler.securityContext`                                             | Pod Scheduler security context. Should be filed as `runAsUser: 1000` for non-root privileges environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                                                                                                                                       | false                                                                                            |
| `podScheduler.customLabels`                                                | Allows specifying custom labels for the OpenSearch scheduler pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                                                                                                                                       | false                                                                                            |
| `monitoring.enabled`                                                       | Enable the installation of OpenSearch monitoring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                     | false                                                                                            |
| `monitoring.dockerImage`                                                   | The docker image of OpenSearch monitoring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_elasticsearch-telegraf:master_latest`                               | false                                                                                            |
| `monitoring.imagePullPolicy`                                               | OpenSearch monitoring container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `Always`                                                                                                                                   | false                                                                                            |
| `monitoring.monitoringType`                                                | The type of output plugin that is used for service monitoring. The possible values are `influxdb` and `prometheus`. If the value of this parameter is `influxdb`, you need to check and specify the parameters necessary for `InfluxDB` plugin (`smDbHost`, `smDbName`, `smDbUsername`, `smDbPassword`). Prometheus plugin does not require additional parameters for the configuration.                                                                                                                                                                          | `prometheus`                                                                                                                               | false                                                                                            |
| `monitoring.installDashboard`                                              | Enable the installation of OpenSearch Grafana dashboard.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                                                                                                                                     | false                                                                                            |
| `monitoring.thresholds.lagAlert`                                           | The maximum value of replication lag until replication alert raised. If not specified, no alert added.                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       | false                                                                                            |
| `monitoring.smDbHost`                                                      | The host of the System Monitoring database. You must specify the parameter only if `monitoringType` parameter is equal to `influxdb`.                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       | true if `monitoring.monitoringType` has value `influxdb`                                         |
| `monitoring.smDbName`                                                      | The name of the database in System Monitoring. You must specify the parameter only if `monitoringType` parameter is equal to `influxdb`.                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       | true if `monitoring.monitoringType` has value `influxdb`                                         |
| `monitoring.smDbUsername`                                                  | The name of the database user in System Monitoring. The parameter should be specified if `monitoringType` parameter is equal to `influxdb` and authentication is enabled in System Monitoring.                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | false                                                                                            |
| `monitoring.smDbPassword`                                                  | The password of the database user in System Monitoring. The parameter should be specified if `monitoringType` parameter is equal to `influxdb` and authentication is enabled in System Monitoring.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       | false                                                                                            |
| `monitoring.opensearchHost`                                                | The host address of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `<fullnameOverride>`                                                                                                                       | false                                                                                            |
| `monitoring.opensearchPort`                                                | The port of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `9200`                                                                                                                                     | false                                                                                            |
| `monitoring.opensearchDbaasAdapterHost`                                    | The host of monitored OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `dbaas-<fullnameOverride>-adapter`                                                                                                         | false                                                                                            |
| `monitoring.opensearchDbaasAdapterPort`                                    | The HTTP port of monitored OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `8080`                                                                                                                                     | false                                                                                            |
| `monitoring.opensearchExecPluginTimeout`                                   | The timeout for OpenSearch exec Telegraf plugin.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `15s`                                                                                                                                      | false                                                                                            |
| `monitoring.resources.requests.cpu`                                        | The minimum number of CPUs the monitoring container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `200m`                                                                                                                                     | false                                                                                            |
| `monitoring.resources.requests.memory`                                     | The minimum amount of memory the monitoring container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                   | `256Mi`                                                                                                                                    | false                                                                                            |
| `monitoring.resources.limits.cpu`                                          | The maximum number of CPUs the monitoring container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `200m`                                                                                                                                     | false                                                                                            |
| `monitoring.resources.limits.memory`                                       | The maximum amount of memory the monitoring container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                      | `256Mi`                                                                                                                                    | false                                                                                            |
| `monitoring.nodeSelector`                                                  | Define which Kubernetes nodes the OpenSearch monitoring pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `monitoring.tolerations`                                                   | The list of toleration policies for OpenSearch monitoring pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       | false                                                                                            |
| `monitoring.affinity`                                                      | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `monitoring.securityContext`                                               | The pod-level security attributes and common container settings. For example, `runAsUser: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{runAsUser: 1000}`                                                                                                                        | false                                                                                            |
| `monitoring.monitoringCoreosGroup`                                         | The `monitoringCoreosGroup` verbs for OpenSearch service operator role. The verbs are presented in role if the parameter value is set to `true`.                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    | false                                                                                            |
| `monitoring.customLabels`                                                  | Allows specifying custom labels for the OpenSearch monitoring pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.enabled`                                                     | Enables the installation of OpenSearch DBaaS adapter that provides connection with credentials with necessary grants only for indices meant for a particular microservice. The migration procedure between Elasticsearch and OpenSearch DBaaS adapter is described in [DBaaS Adapter Migration](#dbaas-adapter) section.                                                                                                                                                                                                                                          | `false`                                                                                                                                    | false                                                                                            |
| `dbaasAdapter.dockerImage`                                                 | The docker image of OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_dbaas-opensearch-adapter:master_latest`                             | false                                                                                            |
| `dbaasAdapter.imagePullPolicy`                                             | OpenSearch DBaaS Adapter container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `Always`                                                                                                                                   | false                                                                                            |
| `dbaasAdapter.dbaasAdapterAddress`                                         | The address of OpenSearch DBaaS adapter, where aggregator should send requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `http://dbaas-<fullnameOverride>-adapter.<namespace>:8080`                                                                                 | false                                                                                            |
| `dbaasAdapter.dbaasUsername`                                               | The name of the DBaaS adapter user, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `""`                                                                                                                                       | true if `dbaasAdapter.enabled: true`                                                             |
| `dbaasAdapter.dbaasPassword`                                               | The password of the DBaaS adapter user, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       | true if `dbaasAdapter.enabled: true`                                                             |
| `dbaasAdapter.dbaasAggregatorRegistrationAddress`                          | The address of aggregator, which should register physical database. You need to specify this only if there are more than one aggregators installed in cloud and you need to choose one, or if the adapter is not in the same cloud, where aggregator is, or if default aggregator is not installed in the default "DBaaS" project. In case of default installation, you need to use the default address.                                                                                                                                                          | `http://dbaas-aggregator.dbaas:8080`                                                                                                       | false                                                                                            |
| `dbaasAdapter.dbaasAggregatorPhysicalDatabaseIdentifier`                   | The unique ID of physical database, which adapter connects to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `<namespace>`                                                                                                                              | false                                                                                            |
| `dbaasAdapter.registrationAuthUsername`                                    | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       | true if `dbaasAdapter.enabled: true`                                                             |
| `dbaasAdapter.registrationAuthPassword`                                    | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       | true if `dbaasAdapter.enabled: true`                                                             |
| `dbaasAdapter.opensearchHost`                                              | The host address of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `<fullnameOverride>`                                                                                                                       | false                                                                                            |
| `dbaasAdapter.opensearchPort`                                              | The port of OpenSearch. If the OpenSearch URL does not contain port for example `https://opensearch`, the default protocol port should be specified: `80` for http and `443` for https.                                                                                                                                                                                                                                                                                                                                                                           | `9200`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.opensearchProtocol`                                          | The protocol of communication with the OpenSearch. The allowed values are `http`, `https`. To access to `https` OpenSearch you need to install trusted TLS certificates for DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                        | `http`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.opensearchRepo`                                              | The name of snapshot repository in OpenSearch. The default behavior is to create a new repository with file storage location for each backup.                                                                                                                                                                                                                                                                                                                                                                                                                     | `snapshots`                                                                                                                                | false                                                                                            |
| `dbaasAdapter.opensearchRepoRoot`                                          | The absolute path in OpenSearch file system where snapshot repositories for backups are created.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `/usr/share/opensearch`                                                                                                                    | false                                                                                            |
| `dbaasAdapter.opensearchClusterVersion`                                    | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.netcrackerOpensearchClusterVersion`                          | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is NetCracker wrapper around OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.tls.enabled`                                                 | Specifies whether TLS is enabled for OpenSearch DBaaS Adapter. This parameter is taken into account only if `global.tls.enabled` parameter is set to `true`.                                                                                                                                                                                                                                                                                                                                                                                                      | `true`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.tls.secretName`                                              | Specifies the secret that contains TLS certificates. It is required if TLS for Opensearch DBaaS Adapter is enabled and certificates generation is disabled.                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.tls.subjectAlternativeName.additionalDnsNames`               | Specifies the list of additional DNS names to be added to the `Subject Alternative Name` field of TLS certificate for Opensearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                   | `[]`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.tls.subjectAlternativeName.additionalIpAddresses`            | Specifies the list of additional IP addresses to be added to the `Subject Alternative Name` field of TLS certificate for Opensearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.resources.requests.cpu`                                      | The minimum number of CPUs the DBaaS adapter container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `200m`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.resources.requests.memory`                                   | The minimum amount of memory the DBaaS adapter container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                | `32Mi`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.resources.limits.cpu`                                        | The maximum number of CPUs the DBaaS adapter container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `200m`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.resources.limits.memory`                                     | The maximum amount of memory the DBaaS adapter container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                   | `32Mi`                                                                                                                                     | false                                                                                            |
| `dbaasAdapter.nodeSelector`                                                | Define which Kubernetes nodes the OpenSearch DBaaS adapter pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.tolerations`                                                 | The list of toleration policies for OpenSearch DBaaS adapter pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.affinity`                                                    | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.securityContext`                                             | The pod-level security attributes and common container settings. For example, `runAsUser: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.customLabels`                                                | Allows specifying custom labels for the OpenSearch DBaaS adapter pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       | false                                                                                            |
| `dbaasAdapter.apiVersion`                                                  | The version of OpenSearch DBaaS Adapter API. Selected version changes strategy of DBaaS Aggregator registration, response format and work. The possible values are `v1`, `v2`. The `v1` version allows to create users only with `admin` permissions, but the `v2` version creates 3 users with different roles (`admin`, `dml`, `readonly`) on each corresponding request. If you are upgraded DBaaS OpenSearch adapter from `v1` to `v2` version, you must not downgrade it.                                                                                    | `v1`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.enabled`                                        | Enables the installation of Elasticsearch DBaaS adapter that provides connection with admin credentials for created indices. The migration procedure between Elasticsearch and OpenSearch DBaaS adapter is described in [DBaaS Adapter Migration](#dbaas-adapter) section.                                                                                                                                                                                                                                                                                        | `false`                                                                                                                                    | false                                                                                            |
| `elasticsearchDbaasAdapter.name`                                           | The base name of all DBaaS Elasticsearch adapter resources: deployment, service, secret, configuration.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `dbaas-elasticsearch-adapter`                                                                                                              | false                                                                                            |
| `elasticsearchDbaasAdapter.dockerImage`                                    | The docker image of DBaaS Elasticsearch Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_dbaas_elasticsearch:master_latest`                                  | false                                                                                            |
| `elasticsearchDbaasAdapter.imagePullPolicy`                                | DBaaS Elasticsearch Adapter container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `Always`                                                                                                                                   | false                                                                                            |
| `elasticsearchDbaasAdapter.dbaasAdapterAddress`                            | The address of DBaaS Elasticsearch Adapter, where aggregator should send requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `http://dbaas-<fullnameOverride>-adapter.<namespace>:8080`                                                                                 | false                                                                                            |
| `elasticsearchDbaasAdapter.dbaasUsername`                                  | The name of the DBaaS Elasticsearch Adapter, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       | true if `elasticsearchDbaasAdapter.enabled: true`                                                |
| `elasticsearchDbaasAdapter.dbaasPassword`                                  | The password of the DBaaS Elasticsearch Adapter user, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | true if `elasticsearchDbaasAdapter.enabled: true`                                                |
| `elasticsearchDbaasAdapter.dbaasAggregatorRegistrationAddress`             | The address of aggregator, which should register physical database. You need to specify this only if there are more than one aggregators installed in cloud and you need to choose one, or if the adapter is not in the same cloud, where aggregator is, or if default aggregator is not installed in the default "DBaaS" project. In case of default installation, you need to use the default address.                                                                                                                                                          | `http://dbaas-aggregator.dbaas:8080`                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.dbaasAggregatorPhysicalDatabaseIdentifier`      | The unique ID of physical database, which DBaaS Elasticsearch Adapter connects to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `<namespace>`                                                                                                                              | false                                                                                            |
| `elasticsearchDbaasAdapter.registrationAuthUsername`                       | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       | true if `elasticsearchDbaasAdapter.enabled: true`                                                |
| `elasticsearchDbaasAdapter.registrationAuthPassword`                       | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       | true if `elasticsearchDbaasAdapter.enabled: true`                                                |
| `elasticsearchDbaasAdapter.opensearchHost`                                 | The host address of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `<fullnameOverride>`                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.opensearchPort`                                 | The port of OpenSearch. If the OpenSearch URL does not contain port for example `https://opensearch`, the default protocol port should be specified: `80` for http and `443` for https.                                                                                                                                                                                                                                                                                                                                                                           | `9200`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.opensearchProtocol`                             | The protocol of communication with the OpenSearch. The allowed values are `http`, `https`. To access to `https` OpenSearch you need to install trusted TLS certificates for DBaaS Elasticsearch Adapter.                                                                                                                                                                                                                                                                                                                                                          | `http`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.opensearchRepo`                                 | The name of snapshot repository in OpenSearch. The default behavior is to create a new repository with file storage location for each backup.                                                                                                                                                                                                                                                                                                                                                                                                                     | `snapshots`                                                                                                                                | false                                                                                            |
| `elasticsearchDbaasAdapter.opensearchRepoRoot`                             | The absolute path in OpenSearch file system where snapshot repositories for backups are created.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `/usr/share/opensearch`                                                                                                                    | false                                                                                            |
| `elasticsearchDbaasAdapter.opensearchClusterVersion`                       | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.netcrackerOpensearchClusterVersion`             | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is NetCracker wrapper around OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.resources.requests.cpu`                         | The minimum number of CPUs the DBaaS Elasticsearch Adapter container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `200m`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.resources.requests.memory`                      | The minimum amount of memory the DBaaS Elasticsearch Adapter container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                  | `32Mi`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.resources.limits.cpu`                           | The maximum number of CPUs the DBaaS Elasticsearch Adapter container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `200m`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.resources.limits.memory`                        | The maximum amount of memory the DBaaS Elasticsearch Adapter container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                     | `32Mi`                                                                                                                                     | false                                                                                            |
| `elasticsearchDbaasAdapter.nodeSelector`                                   | Define which Kubernetes nodes the DBaaS Elasticsearch Adapter pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.tolerations`                                    | The list of toleration policies for DBaaS Elasticsearch Adapter pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.affinity`                                       | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.securityContext`                                | The pod-level security attributes and common container settings. For example, `runAsUser: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       | false                                                                                            |
| `elasticsearchDbaasAdapter.customLabels`                                   | Allows specifying custom labels for the DBaaS Elasticsearch Adapter pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `{}`                                                                                                                                       | false                                                                                            |
| `curator.enabled`                                                          | Enable the installation of OpenSearch curator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `false`                                                                                                                                    | false                                                                                            |
| `curator.dockerImage`                                                      | The docker image of OpenSearch curator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-elastic-curator:master_latest`                               | false                                                                                            |
| `curator.dockerIndicesCleanerImage`                                        | The docker image of OpenSearch indices cleaner.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-elastic-curator:master_latest_elasticsearch_indices_cleaner` | false                                                                                            |
| `curator.imagePullPolicy`                                                  | OpenSearch curator container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `Always`                                                                                                                                   | false                                                                                            |
| `curator.opensearchHost`                                                   | The host address of OpenSearch, including the port.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `<fullnameOverride>:9200`                                                                                                                  | false                                                                                            |
| `curator.snapshotRepositoryName`                                           | The name of snapshot repository in OpenSearch. This parameter determines **logical** name of folder where OpenSearch stores snapshots. This parameter is necessary for OpenSearch internal process to make snapshots. Do not use slash symbol `/` in this name. Please, pay attention that value of this parameter must be the same as the value of the similar parameter for OpenSearch.                                                                                                                                                                         | `snapshots`                                                                                                                                | false                                                                                            |
| `curator.backupSchedule`                                                   | The schedule time in cron format (value must be within quotes). If this parameter is empty, the default schedule (`"0 0 * * *"`), defined in OpenSearch Curator configuration, is used. The value `0 0 * * *` means that snapshots are created everyday at 0:00.                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       | false                                                                                            |
| `curator.evictionPolicy`                                                   | The eviction policy. It is a comma-separated string of policies written as `$start_time/$interval`. This policy splits all backups older then `$start_time` to numerous time intervals `$interval` time long. Then it deletes all backups in every interval except the newest one. For example, `1d/7d` policy means "take all backups older then one day, split them in groups by 7-days interval, and leave only the newest". If this parameter is empty, the default eviction policy (`"0/1d,7d/delete"`) defined in OpenSearch Curator configuration is used. | `""`                                                                                                                                       | false                                                                                            |
| `curator.username`                                                         | The username of the OpenSearch Curator API user. This parameter enables OpenSearch Curator authentication. If the parameter is empty, OpenSearch Curator is deployed with disabled authentication.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       | false                                                                                            |
| `curator.password`                                                         | The password of the OpenSearch Curator API user. This parameter enables OpenSearch Curator authentication. If the parameter is empty, OpenSearch Curator is deployed with disabled authentication.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       | false                                                                                            |
| `curator.tls.enabled`                                                      | Specifies whether TLS is enabled for OpenSearch Curator. This parameter is taken into account only if `global.tls.enabled` parameter is set to `true`. For more information about TLS, see [Encrypted Access](/documentation/installation-guide/encrypted-access/README.md).                                                                                                                                                                                                                                                                                      | `true`                                                                                                                                     | false                                                                                            |
| `curator.tls.secretName`                                                   | Specifies the secret that contains TLS certificates of OpenSearch Curator. It is required if TLS for OpenSearch Curator is enabled and certificates generation is disabled.                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `curator.tls.cipherSuites`                                                 | Specifies the list of cipher suites that are used to secure network connection using TLS or SSL network protocol. If this parameter is not specified, cipher suites are taken from `global.tls.cipherSuites` parameter.                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       | false                                                                                            |
| `curator.tls.subjectAlternativeName.additionalDnsNames`                    | Specifies the list of additional DNS names to be added to the `Subject Alternative Name` field of OpenSearch Curator TLS certificate.                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       | false                                                                                            |
| `curator.tls.subjectAlternativeName.additionalIpAddresses`                 | Specifies the list of additional IP addresses to be added to the `Subject Alternative Name` field of OpenSearch Curator TLS certificate.                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       | false                                                                                            |
| `curator.indicesCleanerSchedulerUnit`                                      | The scheduler unit which specifies measure for value in `curator.indicesCleanerSchedulerUnitCount` parameter. Possible values are `day`, `days`, `friday`, `hour`, `hours`, `minute`, `minutes`, `monday`, `saturday`, `second`, `seconds`, `should_run`, `sunday`, `thursday`, `tuesday`, `wednesday`, `week`, `weeks`.                                                                                                                                                                                                                                          | `days`                                                                                                                                     | false                                                                                            |
| `curator.indicesCleanerSchedulerUnitCount`                                 | The count value for `curator.indicesCleanerSchedulerUnit` parameter. It can be number (`2`) of units specified in `curator.indicesCleanerSchedulerUnit` parameter or particular time (`18:57`) to execute script. For example, `18:51` and `day` in `curator.indicesCleanerSchedulerUnit` parameter mean that cleaner script will be executed every day at `18:51` for current time zone.                                                                                                                                                                         | `1`                                                                                                                                        | false                                                                                            |
| `curator.indicesCleanerConfigurationKey`                                   | The key for yaml key-value pair in `opensearch-indices-cleaner-configuration` config map. The value for this pair should be list of "configuration items". If you change this key in the config map, you should change it in the OpenSearch Curator deployment config.                                                                                                                                                                                                                                                                                            | `patterns_to_delete`                                                                                                                       | false                                                                                            |
| `curator.indicesCleanerConfiguration`                                      | The value for yaml key-value pair in `opensearch-indices-cleaner-configuration` config map. The parameter should represent a list of "configuration items".                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `curator.resources.requests.cpu`                                           | The minimum number of CPUs the curator and indices cleaner containers should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `200m`                                                                                                                                     | false                                                                                            |
| `curator.resources.requests.memory`                                        | The minimum amount of memory the curator and indices cleaner containers should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                 | `256Mi`                                                                                                                                    | false                                                                                            |
| `curator.resources.limits.cpu`                                             | The maximum number of CPUs the curator and indices cleaner containers can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `200m`                                                                                                                                     | false                                                                                            |
| `curator.resources.limits.memory`                                          | The maximum amount of memory the curator and indices cleaner containers use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                        | `256Mi`                                                                                                                                    | false                                                                                            |
| `curator.nodeSelector`                                                     | Define which Kubernetes nodes the OpenSearch curator pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       | false                                                                                            |
| `curator.tolerations`                                                      | The list of toleration policies for OpenSearch curator pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       | false                                                                                            |
| `curator.affinity`                                                         | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `curator.securityContext`                                                  | The pod-level security attributes and common container settings. For example, `fsGroup: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `curator.customLabels`                                                     | Allows specifying custom labels for the OpenSearch curator pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       | false                                                                                            |
| `statusProvisioner.dockerImage`                                            | The image for Deployment Status Provisioner component.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `artifactorycn.netcracker.com:17008/product/prod.platform.streaming_deployment-status-provisioner:master_latest`                           | false                                                                                            |
| `statusProvisioner.cleanupEnabled`                                         | Whether forced cleanup of previous Status Provisioner job is enabled. If the parameter is set to `false` and Kubernetes version is less than `1.21`, then the previous Status Provisioner job must be manually removed before deployment. If the parameter is not defined, then its value is calculated automatically according to the following rules: `false` if Kubernetes version is greater than or equal to `1.21`, `true` if Kubernetes version is less than `1.21`.                                                                                       | `""`                                                                                                                                       | false                                                                                            |
| `statusProvisioner.lifetimeAfterCompletion`                                | The number of seconds that the job remains alive after its completion. This functionality works only since 1.21 Kubernetes version.                                                                                                                                                                                                                                                                                                                                                                                                                               | `600`                                                                                                                                      | false                                                                                            |
| `statusProvisioner.podReadinessTimeout`                                    | The timeout in seconds that the job waits for the monitored resources to be ready or completed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `300`                                                                                                                                      | false                                                                                            |
| `statusProvisioner.integrationTestsTimeout`                                | The timeout in seconds that the job waits for the integration tests to complete.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `300`                                                                                                                                      | false                                                                                            |
| `statusProvisioner.resources.requests.cpu`                                 | The minimum number of CPUs the container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `50m`                                                                                                                                      | false                                                                                            |
| `statusProvisioner.resources.requests.memory`                              | The minimum amount of memory the container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                              | `50Mi`                                                                                                                                     | false                                                                                            |
| `statusProvisioner.resources.limits.cpu`                                   | The maximum number of CPUs the container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `100m`                                                                                                                                     | false                                                                                            |
| `statusProvisioner.resources.limits.memory`                                | The maximum amount of memory the container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                                 | `100Mi`                                                                                                                                    | false                                                                                            |
| `statusProvisioner.customLabels`                                           | Custom labels to be specified in the Status Provisioner pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `{}`                                                                                                                                       | false                                                                                            |
| `integrationTests.enabled`                                                 | Enable the installation of OpenSearch integration tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `false`                                                                                                                                    | false                                                                                            |
| `integrationTests.dockerImage`                                             | The docker image of OpenSearch Service integration tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_opensearch-service:master_latest_integration-tests`                 | false                                                                                            |
| `integrationTests.tags`                                                    | The tags combined with `AND`, `OR` and `NOT` operators that select test cases to run. You can use `smoke`, `authentication`, `backup`, `dbaas` and `ha` tags to run appropriate tests.                                                                                                                                                                                                                                                                                                                                                                            | `smoke`                                                                                                                                    | false                                                                                            |
| `integrationTests.opensearchPort`                                          | The OpenSearch port                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `9200`                                                                                                                                     | false                                                                                            |
| `integrationTests.identityProviderUrl`                                     | The URL of Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | false                                                                                            |
| `integrationTests.identityProviderRegistrationToken`                       | The registration token for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       | false                                                                                            |
| `integrationTests.identityProviderUsername`                                | The name of the user for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       | false                                                                                            |
| `integrationTests.identityProviderPassword`                                | The password for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                              | `""`                                                                                                                                       | false                                                                                            |
| `integrationTests.opensearchDbaasAdapterPort`                              | The DBaaS OpenSearch adapter port. The allowed values are `8080` and `8443`. Use `8443` in case TLS for Opensearch DBaaS Adapter is enabled                                                                                                                                                                                                                                                                                                                                                                                                                       | `8080`                                                                                                                                     | false                                                                                            |
| `integrationTests.prometheusUrl`                                           | The URL (with schema and port) to Prometheus. For example, `http://prometheus.cloud.openshift.sdntest.example.com:80`. This parameter must be specified if you want to run integration tests with `prometheus` tag.                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       | false                                                                                            |
| `integrationTests.resources.requests.cpu`                                  | The minimum number of CPUs the container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `200m`                                                                                                                                     | false                                                                                            |
| `integrationTests.resources.requests.memory`                               | The minimum amount of memory the container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                              | `256Mi`                                                                                                                                    | false                                                                                            |
| `integrationTests.resources.limits.cpu`                                    | The maximum number of CPUs the container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `400m`                                                                                                                                     | false                                                                                            |
| `integrationTests.resources.limits.memory`                                 | The maximum amount of memory the container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                                 | `256Mi`                                                                                                                                    | false                                                                                            |
| `integrationTests.affinity`                                                | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       | false                                                                                            |
| `integrationTests.customLabels`                                            | Allows specifying custom labels for the OpenSearch integration tests pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                       | false                                                                                            |

## Google Cloud Storage for Snapshots

1. Follow the [guide](https://www.elastic.co/guide/en/elasticsearch/reference/8.4/repository-gcs.html#repository-gcs-using-service-account) to create JSON service account file.
2. Create secret with JSON in `opensearch` namespace. For example:

    ```yaml
    kind: Secret
    apiVersion: v1
    metadata:
      name: opensearch-gcs-secret
      namespace: opensearch
    data:
      key: >-
        ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAidGVzdC1wcm9qZWN0IiwKICAicHJpdmF0ZV9rZXlfaWQiOiAidGVzdC1rZXkiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2Z0lCQURBTkJnay4uLi5vSnl4ZVxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogInNhLW9wZW5zZWFyY2gtcnctYnVja2V0QHRlc3QtcHJvamVjdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICIxMTExMTExMTExMTExMTExMTExMTExMTExMTEiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L3NhLW9wZW5zZWFyY2gtcnctYnVja2V0JTQwdGVzdC1wcm9qZWN0LmlhbS5nc2VydmljZWFjY291bnQuY29tIgp9
    type: Opaque
    ```

3. Set `opensearch.snapshots.s3.gcs.secretName` and `opensearch.snapshots.s3.gcs.secretKey` parameters:

    ```yaml
    opensearch:
      snapshots:
        s3:
          gcs:
            secretName: "opensearch-gcs-secret"
            secretKey: "key"
    ```

## Samples

Base parameters example to deploy OpenSearch:

```
opensearch:
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
  securityContextCustom:
    fsGroup: 1000

  master:
    replicas: 3
    nodeSelector:
      role: compute
    javaOpts: "-Xms718m -Xmx718m"
    persistence:
      storageClass: local-storage
      size: 2Gi

  client:
    ingress:
      enabled: true
      hosts:
        - opensearch-opensearch-service.kubernetes.example.com
```

Extended example to deploy OpenSearch with Dashboards, OpenID Connect authentication, Predefined Persistent Volumes and Snapshot repository:

```
dashboards:
  enabled: true
  ingress:
    enabled: true
    hosts:
      - host: dashboards-opensearch-service.kubernetes.example.com
        paths:
          - path: /

opensearch:
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
      oidc:
        openid_connect_url: "http://identity-management-security-services.example.kubernetes.com/.well-known/openid-configuration"

  master:
    replicas: 3
    resources:
      limits:
        cpu: 600m
        memory: 1024Mi
      requests:
        cpu: 200m
        memory: 1024Mi
    javaOpts: "-Xms718m -Xmx718m"
    persistence:
      persistentVolumes:
        - pv1
        - pv2
        - pv3
      nodes:
        - node1
        - node2
        - node3
      size: 2Gi

  client:
    ingress:
      enabled: true
      hosts:
        - opensearch-opensearch-service.kubernetes.example.com

  snapshots:
    enabled: true
    persistentVolume: "pv-snapshots"
    size: 2Gi

podScheduler:
  securityContext:
    runAsUser: 1000
  nodeSelector:
    role: compute

```

Base parameters example to deploy OpenSearch with arbiter nodes:

```
opensearch:
  master:
    enabled: true
    replicas: 2
    nodeSelector: 
      region: primary
    persistence:
      storageClass: "local-path"
    resources:
      limits:
        cpu: 500m
        memory: 2048Mi
  arbiter:
    enabled: true
    replicas: 1
    nodeSelector: 
      region: arbiter
    persistence:
      storageClass: "local-path"
    resources:
      limits:
        cpu: 300m
        memory: 1024Mi
```

Base `CMDB` parameters example to deploy OpenSearch via Groovy Job Deployer:

```
monitoring.enabled=false;
opensearch.securityConfig.authc.basic.password=<pwd>;
opensearch.securityConfig.authc.basic.username=<username>;
opensearch.master.replicas=1;
opensearch.master.nodeSelector='{"region": "<label value>"}';
opensearch.master.javaOpts=-Xms718m -Xmx718m;
opensearch.master.persistence.persistentVolumes='["<pv name>"]';
opensearch.master.persistence.nodes='["<node name>"]';
opensearch.master.persistence.size=2Gi;
opensearch.client.ingress.enabled=true;
opensearch.client.ingress.hosts='["opensearch-core-opensearch.paas-apps10.openshift.sdntest.netcracker.com"]';
dbaasAdapter.enabled=true;
dbaasAdapter.dbaasUsername=dbaas-aggregator;
dbaasAdapter.dbaasPassword=dbaas-aggregator;
dbaasAdapter.dbaasAggregatorRegistrationAddress=http://dbaas-aggregator.dbaas-core:8080;
dbaasAdapter.dbaasAggregatorPhysicalDatabaseIdentifier=core-opensearch;
dbaasAdapter.registrationAuthUsername=cluster-dba;
dbaasAdapter.registrationAuthPassword=Bnmq5567_PO;
dbaasAdapter.requests.memory=32Mi;
dbaasAdapter.requests.cpu=200m;
dbaasAdapter.limits.memory=32Mi;
dbaasAdapter.limits.cpu=200m;
ESCAPE_SEQUENCE=true;
dbaasAdapter.nodeSelector='{"region": "*******"}';
DEPLOY_W_HELM=true;
DISABLE_CRD=true;
```

You can add necessary parameters and sections to these examples to reach expected result.

# Deployment

## Manual Deployment

You can fill `values.yaml` witch necessary parameters or create different one `sample.yaml` and override only required fields (e.g., from [Samples](#samples)).

Then you can deploy release with `helm`:
```
$ helm install ${RELEASE_NAME} ./ -f sample.yaml -n ${NAMESPACE}
```

where:

* `${RELEASE_NAME}` is the release name of Helm Chart for OpenSearch service. For example, `opensearch-service`.
* `${NAMESPACE}` is the OpenShift/Kubernetes project/namespace to deploy OpenSearch service. For example, `opensearch-service`.

You can monitor the deployment process on the OpenShift/Kubernetes dashboard or using `kubectl` in the command line:

```
kubectl get pods
```

## Deployment via DP Deployer Job

To deploy via DP Deployer job, navigate to the Jenkins job `DP.Pub.Helm_deployer` and then click **Build with parameters**.

The job parameters are predefined and described as follows:

The `CLOUD_URL` parameter specifies the URL of the OpenShift/Kubernetes server. For example, `https://search.openshift.sdntest.example.com:8443`.

The `CLOUD_NAMESPACE` parameter specifies the name of the existing OpenShift project/Kubernetes namespace. For example, `opensearch-service`.

The `CLOUD_USER` parameter specifies the name of the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified with `CLOUD_PASSWORD` parameter if `CLOUD_TOKEN` parameter is not specified.

The `CLOUD_PASSWORD` parameter specifies the password for the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified with `CLOUD_USER` parameter if `CLOUD_TOKEN` parameter is not specified.

The `CLOUD_TOKEN` parameter specifies the token for the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified if `CLOUD_USER` and `CLOUD_PASSWORD` parameters are not specified.

The `DESCRIPTOR_URL` parameter specifies the link to the OpenSearch Service Application
Manifest. The images for all components are taken from the manifest.

The `DEPLOYMENT_PARAMETERS` parameter specifies the yaml that contains necessary parameters for installation in yaml format.
You can find examples in [Samples](#samples) section.

The `DEPLOYMENT_MODE` parameter specifies the mode of the deployment.

The `ADDITIONAL_OPTIONS` parameter specifies the additional options for Helm install/upgrade commands. For example,
`--skip-crds` can be used in case of installation with restricted rights.

Click *Build*.

For information about:
* parameters, see [Parameters](#parameters)

## Deployment via Groovy Deployer Job

To deploy via Groovy Deployer job, navigate to the Jenkins job `groovy.deploy.v3` and then click **Build with parameters**.

Descriptors can be found in [TAGS](https://git.netcracker.com/PROD.Platform.ElasticStack/opensearch-service/-/tags) section on GitLab.

The job parameters are predefined and described as follows:

The `PROJECT` parameter specifies the name of the existing OpenShift project/Kubernetes namespace. For example, `opensearch-service`.

The `OPENSHIFT_CREDENTIALS` parameter specifies the credentials of the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.

The `DEPLOY_MODE` parameter specifies the mode of the deployment. The possible values are `Clean Install` and `Rolling Upgrade`.
The `Clean Install` mode removes everything from the project before deployment.

The `ARTIFACT_DESCRIPTOR_VERSION` parameter specifies the version of maven artifact in the format
`artifactId:artifactVersion`. For example, `opensearch-service:charts_v01`.
The images for all components are taken from the maven artifact.

The `CMDB` is the list of necessary parameters for OpenSearch service installation.
All parameters should be divided by `;` and should not contain `"` in values.
You can find examples in [Samples](#samples) section.
Multiline sections can be filled with `'` as follows:
```
opensearch='
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
';
```

**Note**: You should always specify `DEPLOY_W_HELM=true;` as first parameter  and `ESCAPE_SEQUENCE=true;` as last to correct deploy Helm release.

Click *Build*.

For information about:
* parameters, see [Parameters](#parameters)

## Deployment with Restricted Rights

To avoid using `cluster-admin` rights during the deployment, the following conditions are required:

* The cloud administrator creates the namespace/project in advance.
* The following grants should be provided for the `Role` of deployment user:

    ```yaml
    rules:
      - apiGroups:
          - netcracker.com
        resources:
          - "*"
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
      - apiGroups:
          - ""
        resources:
          - pods
          - services
          - endpoints
          - persistentvolumeclaims
          - configmaps
          - secrets
          - pods/exec
          - pods/portforward
          - pods/attach
          - serviceaccounts
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
      - apiGroups:
          - apps
        resources:
          - deployments
          - deployments/scale
          - deployments/status
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
          - deletecollection
      - apiGroups:
          - batch
        resources:
          - jobs
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - create
      - apiGroups:
          - apps
        resources:
          - statefulsets
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - roles
          - rolebindings
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
      - apiGroups:
          - integreatly.org
        resources:
          - grafanadashboards
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
      - apiGroups:
          - monitoring.coreos.com
        resources:
          - servicemonitors
          - prometheusrules
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
    ```
The following rules require cluster-wide permissions. If it is not possible to provide them to the deployment user, you have to apply the resources manually.

* If OpenSearch is installed in the disaster recovery mode and authentication on disaster recovery server is enabled, cluster role binding for `system:auth-delegator` role must be created.

  ```yaml
  kind: ClusterRoleBinding
  apiVersion: rbac.authorization.k8s.io/v1
  metadata:
    name: token-review-crb-NAMESPACE
  subjects:
    - kind: ServiceAccount
      name: opensearch-service-operator
      namespace: NAMESPACE
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: system:auth-delegator
  ```

* Need to create/apply the Custom resource definition `OpenSearchService` for this version. There are 2 options:
  * You can create/apply the CRD manually before installation. The CRD for this version is stored in [crd.yaml](/charts/helm/opensearch-service/crds/crd.yaml):

    ```
    kubectl apply -f crd.yaml
    ```

  * To avoid applying manual the CRD the following grants should be provided for the `ClusterRole` of deployment user:
    ```yaml
      rules:
        - apiGroups: ["apiextensions.k8s.io"]
          resources: ["customresourcedefinitions"]
          verbs: ["get", "create", "patch"]
      ```

* The parameter `global.psp.create` should be defined as `false`.

**Note**: If you deploy OpenSearch Service to Kubernetes version less than `1.16`, you have to manually install CRD from `config/crd/old/netcracker.com_opensearchservices.yaml` and disable automatic CRD creation by Helm.

## Automatic CRD Upgrade

It is possible to upgrade CRD automatically on environment to the latest one which is presented with installing version.
This feature is enabled by default if parameter `DISABLE_CRD` is not `true`.

Automatic CRD upgrade requires the following cluster rights for deploy user:
```yaml
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["get", "create", "patch"]
```

# Migration

## Migration from OpenDistro Elasticsearch

OpenSearch Service allows migration from OpenDistro Elasticsearch deployments. 

There are 3 ways for migration:
1. Automatic via Deploy Job (DP|APP)
2. Manual Steps
3. Backup and Restore

**NOTE:** If you need to migrate from Elasticsearch 6.8 cluster to OpenSearch please follow the [Migrate from Elasticsearch Service](#migrate-from-elasticsearch-68-service).

OpenSearch also can be deployed with the same name as OpenDistro Elasticsearch installation:
```
nameOverride: "elasticsearch"
fullnameOverride: "elasticsearch"
```
In this case no necessary to perform steps for the Persistent Volume migration because names of entities are the same. 
But this is not recommended way, because OpenSearch is the different solution.

**NOTE:** Please read general [Prerequisites](#prerequisites) and perform necessary steps before deploy.

### Automatic Migration with Deploy Job

OpenSearch deploy job can perform migration steps automatically if this feature is enabled in parameters.
It is possible only for helm based installations (`DEPLOY_W_HELM` is `true` from previous and current deployments).
To enabled it you need to add the following properties to deployment params of your job (DP|APP):

| Parameter                       | Description                                                                                           | Default           |
|---------------------------------|-------------------------------------------------------------------------------------------------------|-------------------|
| `ENABLE_MIGRATION`              | Whether to perform automatic migration during deploy. Disable it when migration finished.             | `false`           |
| `ENABLE_HELM_DELETE`            | Whether to delete previous helm releases of OpenDistro Elasticsearch.                                 | `true`            |
| `ENABLE_PV_PATCH`               | Whether to perform patching for existing Persistent Volumes of OpenDistro Elasticsearch to save data. | `true`            |
| `PREVIOUS_CUSTOM_RESOURCE_NAME` | The previous name of OpenDistro Elasticsearch cluster.                                                | `"elasticsearch"` |
| `PREVIOUS_DEDICATED_ARBITER`    | Whether existing OpenDistro Elasticsearch cluster contain dedicated arbiter nodes.                    | `false`           |
| `PREVIOUS_DEDICATED_DATA`       | Whether existing OpenDistro Elasticsearch cluster contain dedicated data nodes.                       | `false`           |

**Important:** the option `ENABLE_PV_PATCH` requires cluster rights for editing Persistent Volumes for deploy user. 
If you want to enable automatic migration your user for deploy should have the following cluster role rights:
```yaml
  - apiGroups:
      - ""
    resources:
      - persistentvolumes
    verbs:
      - create
      - get
      - list
      - patch
      - watch
```

Basically it is necessary to add only `ENABLE_MIGRATION: true` to deploy parameters to enable migration feature.

You also need to specify your previous Persistent Volumes and storage class for parameters of OpenSearch `persistence` sections, and previous Persistent Volume Claim for `snapshots` if you want to save previous data. 
For example:
```yaml
ENABLE_MIGRATION: true

opensearch:
  master:
    replicas: 3
    persistence:
      enabled: true
      storageClass: local-storage
      persistentVolumes:
        - pv-elasticsearch-1
        - pv-elasticsearch-2
        - pv-elasticsearch-3
  snapshots:
    enabled: true
    persistentVolumeClaim: pvc-elasticsearch-snapshots
```
**Important:** do not use `Clean Install` mode for App Deployer Job. Use the `Rolling Update` mode for App Deployer and `auto` or `install` mode for DP Deployer.

**NOTE:** if something went wrong with automatic migration the process will be interrupted, you need to perform migration procedure manually with the guide below. 

### Manual Migration Steps

The following steps should be performed from the host with installed `kubectl`, `helm` and cluster admin rights to the cluster.

1. Uninstall existing OpenDistro Elasticsearch helm release:
    
    For APP Deployer installations:
    ```
    helm uninstall elasticsearch-service
    ```
   
    For DP Deployer installations:
    ```
    helm uninstall elasticsearch-service-{NAMESPACE}
    ```
   
    Or all resources if previous installation was not helm based:
    ```
    kubectl delete all --all -n {NAMESPACE}
    kubectl delete secret --all -n {NAMESPACE}
    kubectl delete configmap --all -n {NAMESPACE}
    ```
2. Patch existing Persistent Volumes of Elasticsearch data (not snapshot) to `Retain` policy:
   ```
   kubectl patch pv <your-pv-name> -p '{"spec":{"persistentVolumeReclaimPolicy":"Retain"}}'
   ```
   You can get the Persistent Volume names from the Persistent Volume Claims via ```kubectl get pvc```.
3. Delete existing Persistent Volumes Claims of Elasticsearch data (not snapshot):
   ```
   kubectl delete pvc <your-pvc-name>
   ```
4. Patch existing Persistent Volumes of Elasticsearch data (not snapshot) to available status:
   ```
   kubectl patch pv <your-pv-name> -p '{"spec":{"claimRef": null}}'
   ```
5. Deploy OpenSearch service specifying the previous Persistent Volumes and storage class for OpenSearch persistent parameters and previous Persistent Volume Claim for snapshot:
   For example:
    ```yaml
    opensearch:
      master:
        replicas: 3
        persistence:
          enabled: true
          storageClass: local-storage
          persistentVolumes:
            - pv-elasticsearch-1
            - pv-elasticsearch-2
            - pv-elasticsearch-3
      snapshots:
        enabled: true
        persistentVolumeClaim: pvc-elasticsearch-snapshots
    ```
   Any deploy mode can be used.

### Backup and Restore

With this approach snapshots collected on Elasticsearch side and restored on OpenSearch side. This migration also requires manual steps.

**Prerequisites:** Elasticsearch and OpenSearch clusters should be installed with enabled independent snapshots storages (Separate snapshot PVC with access from all Elasticsearch/OpenSearch pods)

1. Perform manual backup on Elasticsearch side:
   * From any Elasticsearch pod run backup procedure (All pods have access to snapshots, so it doesn't matter, what pod to choose here and below):
     ```bash
     curl -XPUT -u username:password "http://localhost:9200/_snapshot/${SNAPSHOTS_REPOSITORY_NAME:-snapshots}/${SNAPSHOT_NAME:-elasticsearch_snapshot}?wait_for_completion=true"
     ```
     with Elasticsearch `username:password` specified.
   
   * Check snapshot status and indices from response.

     Additional information about manual backup described in [Manual backup guide](https://git.netcracker.com/PROD.Platform.ElasticStack/elasticsearch-service/-/blob/master/documentation/maintenance-guide/backup/manual-backup-procedure.md):
   
2. Copy `snapshots` directory from Elasticsearch side:
   * Use kubectl with config on Elasticsearch cluster:
     ```
     kubectl cp elasticsearch-pod-name:/usr/share/elasticsearch/snapshots ./snapshots/ -n elasticsearch-namespace
     ```
     with `elasticsearch-pod-name` and `elasticsearch-namespace`. Snapshots will be copied to local path `./snapshots`.

3. Copy `snapshots` directory from local environment to OpenSearch cluster:
   * Use kubectl with config on OpenSearch cluster
     ```
     kubectl cp ./snapshots/ opensearch-pod-name:/usr/share/opensearch -n opensearch-namespace
     ```
     with `opensearch-pod-name` and `opensearch-namespace`. Snapshots will be copied from local path `./snapshots`.

4. Perform manual restore on OpenSearch side:
   * From any OpenSearch pod run restore procedure
     ```bash
     curl -XPOST -u username:password "http://localhost:9200/_snapshot/${SNAPSHOTS_REPOSITORY_NAME:-snapshots}/${SNAPSHOT_NAME:-elasticsearch_snapshot}/_restore"
     ```
     with OpenSearch `username:password` specified and `SNAPSHOT_NAME` the same, that was defined for backup on Elasticsearch side.
   
   * Check that response is `"accepted":true`. Otherwise, some problem occurred and described in response, such as already existing open index in new cluster, but if OpenSearch cluster has clean installation, no conflicts expected. If such problem reproduced, close or delete indices that already exists or use renaming pattern. 
     
     Additional information about manual snapshot recovery described in [Manual recovery guide](https://git.netcracker.com/PROD.Platform.ElasticStack/elasticsearch-service/-/blob/master/documentation/maintenance-guide/recovery/manual-recovery-procedure.md) 

### Migrate from Elasticsearch 6.8 Service

It is also possible to migrate from Elasticsearch 6.8 installations, but only with manual steps.

#### Migrate Elasticsearch 6.8 Persistent Volumes

1. Folder rights
   If previously Persistent Volumes `hostPath` folders were created with rights `100:101` it is necessary to change folders owner to `1000:1000`.

   If running as root user is allowed you need to add the following deploy parameters:
    ```
    opensearch:
      securityContextCustom:
        runAsUser: 1000
        fsGroup: 1000
      fixMount:
        enabled: true
        securityContext:
          runAsUser: 0
    ```

   If running as root user is not allowed you need to change folders owner manually:
    ```
    chown 1000:1000 -R /data/pv1
    ```
   The same for the snapshot persistent volume.

2. Naming and Persistent Volume Claims

   If persistent volume claims exist and have naming `pvc-opensearch-0(1,2)` then you can use them without specifying storage class or persistent volume names.

   If you use `hostPath` predefined persistent volumes you need to specify `nodes` to assign pods:
    ```
    opensearch:
      master:
        persistence:
          nodes:
            - node-1
            - node-2
            - node-3
    ```

   If persistent volume claims have another naming you have to specify both `persistentVolumes` and `nodes` during deploy.

   If PV were created with `storageClass` you need to specify it without specifying `nodes`.

   Creating new PVC for existing utilized PV requires you to unbind Persistent Volumes from previous Claims. You can do it with command:
    ```
    kubectl patch pv pv1 -p '{"spec":{"claimRef": null}}'
    ``` 
   Old PVCs should be removed with removing deployments of previous installation.

#### Manual Migration from Elasticsearch 6.8

1. Perform steps from [Migrate Elasticsearch 6.8 Persistent Volumes](#migrate-elasticsearch-68-persistent-volumes).
2. Delete previous deployments

   Delete previous helm release. For example:
    ```
    helm uninstall elasticsearch-service -n elasticsearch-cluster
    ```

   Delete previous non-helm resources. For example:
    ```
    kubectl delete secret --all -n elasticsearch-cluster
   
    kubectl delete configmap --all -n elasticsearch-cluster
    ```
3. Install OpenSearch release.

## DBaaS adapter

There is no migration between the Elasticsearch DBaaS adapter and the OpenSearch DBaaS adapter, because they use different approaches for managing resources and different microservice clients.

If you want to upgrade OpenSearch service from `0.0.2` or lower version to `0.0.3` or higher version, you need to decide which DBaaS adapter you want to use. If you want to continue using the Elasticsearch DBaaS adapter, you have to update your installation parameters and replace the following part:

```
dbaasAdapter:
  enabled: true
  ...
```

with the following:

```
elasticsearchDbaasAdapter:
  enabled: true
  ...
```

If you want to use the OpenSearch DBaaS adapter, you have to manually adapt service with one of the following options:

* Edit `physical_database` table in Postgres that is used by DBaaS aggregator:

  * Find the record in the `physical_database` table that matches your `physical_database_identifier` with the following command:

    ```
    select * from physical_database where physical_database_identifier='<physical_database_identifier>';
    ```

  * Change the type of the found physical database from `elasticsearch` to `opensearch` with the following command:

    ```
    update physical_database set type = 'opensearch' where physical_database_identifier='<physical_database_identifier>';
    ```

  * Restart DBaaS aggregator.

* Add or update `dbaasAdapter.dbaasAggregatorPhysicalDatabaseIdentifier` parameter in OpenSearch service parameters during its installation. For example,

  ```
  dbaasAdapter:
    ...
    dbaasAggregatorPhysicalDatabaseIdentifier: "opensearch-dbaas-adapter"
  ```

  **Pay attention**, the value of this parameter should differ from the default value (the name of namespace where OpenSearch service is located).

# Custom Resource Definition

Custom resource definition versioning allows to have different incompatible CRD versions of the OpenSearch Service in several namespaces of OpenShift/Kubernetes. Each OpenSearch Service is placed in separate namespace and controlled by corresponding operator. Each operator reconciles the only version of the application, which it is compatible with.

## Apply New Custom Resource Definition Version

You can apply new custom resource definition version with versioning.

### Custom Resource Definition with Versioning

If the CRD is created manually, apply the new version of CRD with the following command:

```
kubectl apply -f charts/helm/opensearch-service/crds/crd.yaml
```

If the CRD is created using Helm, apply the new version of CRD with the following command:

```
kubectl replace -f charts/helm/opensearch-service/crds/crd.yaml
```

**Note**: For old versions of Kubernetes or OpenShift applying CRD may fail. For more information, refer to [CRD Creation Failed on OpenShift 3.11](../maintenance-guide/troubleshooting-guide/README.md#crd-creation-failed-on-openshift-311) section in the _Cloud Platform Troubleshooting Guide_.
