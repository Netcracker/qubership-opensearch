This guide provides information about the installation of OpenSearch cluster on OpenShift/Kubernetes.

Topics covered in this section:
- [Prerequisites](#prerequisites)
- [Installation modes](#installation-modes)
- [Parameters](#parameters)
- [Deployment](#deployment)
    - [Manual Deployment](#manual-deployment)
    - [Deployment via DP Deployer Job](#deployment-via-dp-deployer-job)
    - [Deployment via Groovy Deployer Job](#deployment-via-groovy-deployer-job)
- [Migration from Elasticsearch Service](#migration-from-elasticsearch-service)
    - [Migrate Persistent Volumes](#migrate-persistent-volumes)
    - [From OpenShift DVM Installation](#from-openshift-dvm-installation)
    - [From Kubernetes Helm Chart Installation](#from-kubernetes-helm-chart-installation)
- [Custom Resource Definition](#custom-resource-definition)

# Prerequisites

Before you begin, ensure the following requirements are met:

* Kubernetes 1.16+ or OpenShift 4.3+
* `kubectl` 1.16+ or `oc` 4.3+ CLI
* Helm 3.0+
* All required CRDs are installed

The following Custom Resource Definitions should be installed to the cloud before the installation of OpenSearch:

* `OpenSearchService` - When you deploy with restricted rights or creating CRDs, it is disabled by the Deployer job. You also have to apply the CRD manually when performing the `Upgrade` operation for the version where the CRD is changed (tags usually contain this information). [CRDs folder](../../charts/helm/opensearch-service/crds).
* `GrafanaDashboard`, `PrometheusRule`, and `ServiceMonitor` - They should be installed when you deploy OpenSearch monitoring with `monitoring.monitoringType=prometheus`. You need to install the Monitoring Operator service before the OpenSearch installation.

**Important**: To create CRDs, you must have cloud admin rights. If the deployment user does not have the `cluster-admin` rights, you need to perform the steps described in the [Deployment with Restricted Rights](#deployment-with-restricted-rights) section before the installation.

**Note**: If you deploy OpenSearch service to Kubernetes version less than 1.16, you have to manually install CRD from `config/crd/old/netcracker.com_opensearchservices.yaml` and disable automatic CRD creation by Helm in the following way:

* Specify `--skip-crds` in `ADDITIONAL_OPTIONS` parameter of DP Deployer Job.
* Specify `DISABLE_CRD=true;` in `CUSTOM_PARAMS` parameter of Groovy Deployer Job.

Environment:

* `vm.max_map_count` should be `262144`. To do this, use the following command on all Kubernetes nodes, where OpenSearch is running:

   ```bash
   sysctl -w vm.max_map_count=262144
   ```

  This operation can be performed automatically during installation if `opensearch.sysctl.enabled` is `true`, but it requires the permission to run privileged containers for the cluster.
  **Pay attention**: running privileged containers is usually denied for public clouds.

* If you use predefined `hostPath` persistent volumes, set the appropriate `UID` and `GID` on the `hostPath` directories and rule for SELinux:

   ```
   chown -R 1000:1000 /var/lib/origin/openshift.local.volumes/<pv-name>
   chcon -R unconfined_u:object_r:container_file_t:s0 /var/lib/origin/openshift.local.volumes/<pv-name>
   ```

  **Note**: `1000` UID is the default value. If user is different from `1000`, you need to annotate project with corresponding user.

  These labels are generated automatically when you use the `pv-creator` utility to create them.
  You can specify the `persistence.persistentVolumes` parameter for `master` and `data` to use pre-created persistent volumes with other naming rules.

* If you install OpenSearch service on OpenSearch service you need to execute steps from [Migrate from Elasticsearch Service](#migration-from-elasticsearch-service).

# Installation modes

## Joint

The OpenSearch `joint` installation mode implies that each node has `master`, `data` and `client` roles.

## Separate

The OpenSearch `separate` installation mode implies that each node either has one of the `master`,
`data` and `client` roles or a combination of the two. For example, OpenSearch installation has
3 `master` nodes, 2 `data` nodes and 2 `client` nodes, or 3 nodes with `data` and `master` roles and
2 `client` nodes.

If `data` and `master` nodes are separated, it is important to specify persistent storages not only
for `data` nodes but also for `master` nodes.
The size of persistent storage for `master` node should be small. For example, `1Gi`.

## Deploy with Arbiter

OpenSearch `arbiter` nodes installed to Kubernetes nodes different from `master` provide stability of OpenSearch cluster if `master` nodes went down.
**Important**: `arbiter` nodes do not store any indices data, but still need PV to work, the size of persistent storage for `arbiter` node should be small.
You can find example of the base parameters for the installation in [samples](#samples) section.

# Parameters

The section lists the configurable parameters of the OpenSearch chart and their default values.

The `nameOverride` parameter specifies the name for OpnSearch resources if `fullnameOverride` 


nameOverride: "opensearch"
fullnameOverride: "opensearch"

| Parameter                                                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Default                                                                                                                                    |
|------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| `fullnameOverride`                                         | The base name for all OpenSearch resources (Services, StatefulSets, etc)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `"opensearch"`                                                                                                                             |
| `global.clusterName`                                       | Name of OpenSearch cluster                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `"opensearch"`                                                                                                                             |
| `global.psp.create`                                        | Create and use `podsecuritypolicy`  resources                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `"true"`                                                                                                                                   |
| `global.rbac.enabled`                                      | Create and use `rbac` resources                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"true"`                                                                                                                                   |
| `global.imagePullSecrets`                                  | Global Docker registry secret names as an array                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `[]` (does not add image pull secrets to deployed pods)                                                                                    |
| `global.disasterRecovery.image`                            | The Disaster Recovery OpenSearch operator container image.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `artifactorycn.netcracker.com:17008/product/prod.platform.streaming_disaster-recovery-daemon:master_latest`                                |
| `global.disasterRecovery.httpAuth.enabled`                 | This parameter specifies if authentication should be enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                     |  
| `global.disasterRecovery.httpAuth.smNamespace`             | The name of Kubernetes Namespace from which site manager API calls will be done.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `site-manager`                                                                                                                             |
| `global.disasterRecovery.httpAuth.smServiceAccountName`    | The name of Kubernetes Service Account under which site manager API calls will be done.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `sm-auth-sa`                                                                                                                               |
| `global.disasterRecovery.httpAuth.restrictedEnvironment`   | If the parameter is `true` the `system:auth-delegator` cluster role will be bound to OpenSearch operator service account. The cluster role will be not bound if the disaster recovery mode is disabled, or the disaster recovery server authentication is disabled.                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                    |
| `global.disasterRecovery.mode`                             | Specifies whether the current side is active during service installation in Disaster Recovery mode. If you do not specify this parameter, the service is deployed in a regular mode, not Disaster Recovery mode. The possible values are `active`,`standby`,`disabled`                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       |
| `global.disasterRecovery.indicesPattern`                   | The regular expression which will be used to find OpenSearch indices for cross cluster replication.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `.*`                                                                                                                                       |
| `global.disasterRecovery.remoteCluster`                    | The URL of "active" OpenSearch service. For example, `opensearch.opensearch-service:9300` where `opensearch` is Kubernetes service, `opensearch-service` is Kubernetes namespace, `9300` is transport port.                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       | 
| `global.disasterRecovery.siteManagerEnabled`               | Enables creation of a Kubernetes Custom Resource for `SiteManager`. This property is used for inner developers purposes.                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                                                                                                                                     |
| `global.disasterRecovery.afterServices`                    | The list of `SiteManager` names for services after which the OpenSearch service switchover is to be run.                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       |           
| `dashboards.enabled`                                       | Enable the installation of Dashboards                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `true`                                                                                                                                     |
| `dashboards.dockerImage`                                   | The docker image of Dashboards.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `artifactorycn.netcracker.com:17064/opensearchproject/opensearch-dashboards:1.2.0`                                                         |
| `dashboards.imagePullPolicy`                               | Dashboards container image pull policy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `Always`                                                                                                                                   |
| `dashboards.replicas`                                      | Number of Dashboards instances to deploy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `1`                                                                                                                                        |
| `dashboards.port`                                          | Internal Port for service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `5601`                                                                                                                                     |
| `dashboards.externalPort`                                  | External Port for service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `443`                                                                                                                                      |
| `dashboards.resources`                                     | Dashboards pod resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                       |
| `dashboards.opensearchAccount.secret`                      | The name of the secret with the Dashboards server user as configured in your dashboards.yml                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       |
| `dashboards.opensearchAccount.keyPassphrase.enabled`       | Enable mounting in key passphrase for the `opensearchAccount`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `false`                                                                                                                                    |
| `dashboards.configDirectory`                               | Location of where to mount in Dashboards specific configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"/usr/share/opensearch/config"`                                                                                                           |
| `dashboards.certsDirectory`                                | Location of where to mount in Dashboards certs configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `"/usr/share/opensearch/certs"`                                                                                                            |
| `dashboards.ingress.enabled`                               | Enable Dashboards Ingress                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    |
| `dashboards.ingress.annotations`                           | Dashboards Ingress annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `dashboards.ingress.hosts`                                 | Dashboards Ingress Hostnames                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       |
| `dashboards.ingress.tls`                                   | Dashboards Ingress TLS configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `dashboards.ingress.labels`                                | Dashboards Ingress labels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                       |
| `dashboards.ingress.path`                                  | Dashboards Ingress paths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       |
| `dashboards.service.type`                                  | The type of Dashboards service.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `ClusterIP`                                                                                                                                |
| `dashboards.service.annotations`                           | The annotations that should be specified on Dashboards service.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       |
| `dashboards.config`                                        | Dashboards Configuration (`dashboards.yml`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       |
| `dashboards.nodeSelector`                                  | Define which Nodes the Pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `dashboards.affinity`                                      | The affinity scheduling rules for Dashboards.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `dashboards.podAnnotations`                                | Dashboards pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       |
| `dashboards.securityContext`                               | Dashboards security context. Should be filed as `runAsUser: 1000` for non-root privileges environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       |
| `dashboards.tolerations`                                   | If specified, the pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `dashboards.serviceAccount.create`                         | Create a default service account for Dashboards to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     |
| `dashboards.serviceAccount.name`                           | Name for Dashboards service account                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `dashboards.extraEnvs`                                     | Extra environments variables to be passed to Dashboards                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `[]`                                                                                                                                       |
| `dashboards.extraVolumes`                                  | Array of extra volumes to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       |
| `dashboards.extraVolumeMounts`                             | Array of extra volume mounts to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       |
| `dashboards.extraInitContainers`                           | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       |
| `dashboards.extraContainers`                               | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                                                                                                                                       |
| `dashboards.readinessProbe`                                | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `dashboards.livenessProbe`                                 | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `dashboards.startupProbe`                                  | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `operator.dockerImage`                                     | The docker image of OpenSearch Service Operator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_opensearch-service:master_latest`                                   |
| `operator.replicas`                                        | The number of OpenSearch Service Operator pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `1`                                                                                                                                        |
| `operator.tolerations`                                     | The list of toleration policies for OpenSearch Service Operator pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `operator.affinity`                                        | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `opensearch.discoveryOverride`                             | For hot/warm architectures. Allows second aliased deployment to find cluster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       |
| `opensearch.fixmount.enabled`                              | Enable initContainer to fix mount permissions. Not required if setting a fsGroup via securityContext                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `false`                                                                                                                                    |
| `opensearch.sys_chroot.enabled`                            | Enable giving OpenSearch containers the "SYS_CHROOT" capability.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    |
| `opensearch.sysctl.enabled`                                | Enable initContainer to set sysctl "vm.max_map_count"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `false`                                                                                                                                    |
| `opensearch.securityConfig.enabled`                        | Use custom [security configs](https://github.com/opensearch-project/security/tree/main/securityconfig).                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `"true"`                                                                                                                                   |
| `opensearch.securityConfig.authc.basic.username`           | Username for default admin OpenSearch user. REQUIRED.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `opensearch.securityConfig.authc.basic.password`           | Password for default admin OpenSearch user. REQUIRED.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `opensearch.securityConfig.authc.oidc.openid_connect_url`  | Url of OpenID Connect Identity Provider's well known endpoint. If specified the openid connect authentication is enabled. For example, `"http://idp:8080/.well-known/openid-configuration"`                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       |
| `opensearch.securityConfig.authc.oidc.subject_key`         | The key in the JSON payload that stores the users name. If not defined, the subject registered claim is used.                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `"preferred_username"`                                                                                                                     |
| `opensearch.securityConfig.authc.oidc.roles_key`           | The key in the JSON payload that stores the users roles. The value of this key must be a comma-separated list of roles. Required only if you want to use roles in the JWT.                                                                                                                                                                                                                                                                                                                                                                                       | `"preferred_username"`                                                                                                                     |
| `opensearch.securityConfig.path`                           | Path to security config files                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `"/usr/share/opensearch/plugins/opensearch-security/securityconfig"`                                                                       |
| `opensearch.securityConfig.actionGroupsSecret`             | Name of secret with [action_groups.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/action_groups.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       |
| `opensearch.securityConfig.configSecret`                   | Name of secret with [config.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/config.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       |
| `opensearch.securityConfig.internalUsersSecret`            | Name of secret with [internal_users.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/internal_users.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       |
| `opensearch.securityConfig.rolesSecret`                    | Name of secret with [roles.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/roles.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       |
| `opensearch.securityConfig.rolesMappingSecret`             | Name of secret with [roles_mapping.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/roles_mapping.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       |
| `opensearch.securityConfig.tenantsSecret`                  | Name of secret with [tenants.yml](https://github.com/opensearch-project/security/tree/main/securityconfig/tenants.yml) defined                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `opensearch.securityContextCustom`                         | securityContext for the OpenSearch pods                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                       |
| `opensearch.ssl.transport.existingCertSecret`              | Name of secret that contains the transport certs. If the value is not specified, the secret with transport certificates named `<fullname>-transport-certs` is created, where `<fullname>` is OpenSearch full name                                                                                                                                                                                                                                                                                                                                                 | `""`                                                                                                                                       |
| `opensearch.ssl.transport.existingCertSecretCertSubPath`   | Subpath of elastic transport cert secret. This parameter is not taken into account if `opensearch.ssl.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                            | `"elk-transport-crt.pem"`                                                                                                                  |
| `opensearch.ssl.transport.existingCertSecretKeySubPath`    | Subpath of elastic transport key secret. This parameter is not taken into account if `opensearch.ssl.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                             | `"elk-transport-key.pem"`                                                                                                                  |
| `opensearch.ssl.transport.existingCertSecretRootCASubPath` | Subpath of elastic transport root ca secret. This parameter is not taken into account if `opensearch.ssl.transport.existingCertSecret` parameter is empty                                                                                                                                                                                                                                                                                                                                                                                                         | `"elk-transport-root-ca.pem"`                                                                                                              |
| `opensearch.ssl.rest.enabled`                              | Enable REST SSL for OpenSearch                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `false`                                                                                                                                    |
| `opensearch.ssl.rest.existingCertSecret`                   | Name of secret that contains the OpenSearch REST certs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       |
| `opensearch.ssl.rest.existingCertSecretCertSubPath`        | Subpath of elastic rest cert secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"elk-rest-crt.pem"`                                                                                                                       |
| `opensearch.ssl.rest.existingCertSecretKeySubPath`         | Subpath of elastic rest key secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `"elk-rest-key.pem"`                                                                                                                       |
| `opensearch.ssl.rest.existingCertSecretRootCASubPath`      | Subpath of elastic rest root ca secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"elk-rest-root-ca.pem"`                                                                                                                   |
| `opensearch.ssl.admin.existingCertSecret`                  | Name of secret that contains the admin users OpenSearch certs. If the value is not specified, the secret with admin certificates named `<fullname>-admin-certs` is created, where `<fullname>` is OpenSearch full name.                                                                                                                                                                                                                                                                                                                                           | `""`                                                                                                                                       |
| `opensearch.ssl.admin.existingCertSecretCertSubPath`       | Subpath of elastic admin cert secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"admin-crt.pem"`                                                                                                                          |
| `opensearch.ssl.admin.existingCertSecretKeySubPath`        | Subpath of elastic admin key secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"admin-key.pem"`                                                                                                                          |
| `opensearch.ssl.admin.existingCertSecretRootCASubPath`     | Subpath of elastic admin root ca secret                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `"admin-root-ca.pem"`                                                                                                                      |
| `opensearch.master.enabled`                                | Enables the OpenSearch Master                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `true`                                                                                                                                     |
| `opensearch.master.replicas`                               | Number of OpenSearch masters to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `3`                                                                                                                                        |
| `opensearch.master.resources`                              | OpenSearch masters resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `opensearch.master.javaOpts`                               | OpenSearch masters configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms512m -Xmx512m"`                                                                                                                      |
| `opensearch.master.podDisruptionBudget.enabled`            | If true, create a disruption budget for OpenSearch master                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    |
| `opensearch.master.podDisruptionBudget.minAvailable`       | Minimum number / percentage of pods that [should remain scheduled](https://kubernetes.io/docs/tasks/run-application/configure-pdb/#think-about-how-your-application-reacts-to-disruptions)                                                                                                                                                                                                                                                                                                                                                                        | `1`                                                                                                                                        |
| `opensearch.master.podDisruptionBudget.maxUnavailable`     | Maximum number / percentage of pods that [may be unscheduled](https://kubernetes.io/docs/tasks/run-application/configure-pdb/#think-about-how-your-application-reacts-to-disruptions)                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `opensearch.master.tolerations`                            | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       |
| `opensearch.master.nodeSelector`                           | Define which Nodes the master pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                       |
| `opensearch.master.affinity`                               | The affinity scheduling rules for OpenSearch masters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       |
| `opensearch.master.podAnnotations`                         | OpenSearch master pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       |
| `opensearch.master.livenessProbe`                          | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `opensearch.master.readinessProbe`                         | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `opensearch.master.startupProbe`                           | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `opensearch.master.updateStrategy`                         | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the master `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                           | `RollingUpdate`                                                                                                                            |
| `opensearch.master.persistence.enabled`                    | OpenSearch master enable persistent storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `true`                                                                                                                                     |
| `opensearch.master.persistence.existingClaim`              | OpenSearch master persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | disabled by default, see `values.yaml`                                                                                                     |
| `opensearch.master.persistence.subPath`                    | OpenSearch master persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `opensearch.master.persistence.storageClass`               | OpenSearch master storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | see `values.yaml` for defaults                                                                                                             |
| `opensearch.master.persistence.persistentVolumes`          | The list of OpenSearch master predefined persistent volumes. The number of PVs should be equal to number of master replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                       | [ ]                                                                                                                                        |
| `opensearch.master.persistence.nodes`                      | The list of Kubernetes node names to assign OpenSearch master pods. The number of nodes should be equal to number of master replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                      | [ ]                                                                                                                                        |
| `opensearch.master.persistence.accessModes`                | OpenSearch master persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `- ReadWriteOnce`                                                                                                                          |
| `opensearch.master.persistence.size`                       | OpenSearch master persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `"5Gi"`                                                                                                                                    |
| `opensearch.master.persistence.annotations`                | OpenSearch master persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       |
| `opensearch.master.extraInitContainers`                    | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       |
| `opensearch.master.extraContainers`                        | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                                                                                                                                       |
| `opensearch.arbiter.enabled`                               | Enables the OpenSearch arbiter. OpenSearch arbiter pods installed to different kubernetes node than master provide OpenSearch cluster stability if master nodes went down. **Important** arbiter pods do not store any indices data.                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                     |
| `opensearch.arbiter.replicas`                              | Number of OpenSearch arbiter to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `1`                                                                                                                                        |
| `opensearch.arbiter.resources`                             | OpenSearch arbiter resource requests and limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       |
| `opensearch.arbiter.javaOpts`                              | OpenSearch arbiter configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms512m -Xmx512m"`                                                                                                                      |
| `opensearch.arbiter.tolerations`                           | The list of toleration policies for OpenSearch arbiter pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       |
| `opensearch.arbiter.nodeSelector`                          | Define which Nodes the arbiter pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       |
| `opensearch.arbiter.affinity`                              | The affinity scheduling rules for OpenSearch arbiter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       |
| `opensearch.arbiter.podAnnotations`                        | OpenSearch arbiter pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `{}`                                                                                                                                       |
| `opensearch.arbiter.livenessProbe`                         | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `opensearch.arbiter.readinessProbe`                        | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `opensearch.arbiter.startupProbe`                          | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `opensearch.arbiter.updateStrategy`                        | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the arbiter `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                          | `RollingUpdate`                                                                                                                            |
| `opensearch.arbiter.persistence.enabled`                   | Enables persistent storage for OpenSearch arbiter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                     |
| `opensearch.arbiter.persistence.existingClaim`             | OpenSearch arbiter persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                       |
| `opensearch.arbiter.persistence.subPath`                   | OpenSearch arbiter persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `""`                                                                                                                                       |
| `opensearch.arbiter.persistence.storageClass`              | OpenSearch arbiter storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `opensearch.arbiter.persistence.persistentVolumes`         | The list of OpenSearch arbiter predefined persistent volumes. The number of PVs should be equal to number of master replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                      | [ ]                                                                                                                                        |
| `opensearch.arbiter.persistence.nodes`                     | The list of Kubernetes node names to assign OpenSearch arbiter pods. The number of nodes should be equal to number of master replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                     | [ ]                                                                                                                                        |
| `opensearch.arbiter.persistence.accessModes`               | OpenSearch arbiter persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `- ReadWriteOnce`                                                                                                                          |
| `opensearch.arbiter.persistence.size`                      | OpenSearch arbiter persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"5Gi"`                                                                                                                                    |
| `opensearch.arbiter.persistence.annotations`               | OpenSearch arbiter persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       |
| `opensearch.arbiter.extraInitContainers`                   | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       |
| `opensearch.arbiter.extraContainers`                       | Array of extra containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                            |
| `opensearch.client.enabled`                                | Enables the OpenSearch Client/Ingester                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     |
| `opensearch.client.dedicatedPod.enabled`                   | Enables dedicated deployment for client/ingest. Otherwise master nodes as client/ingest                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `false`                                                                                                                                    |
| `opensearch.client.replicas`                               | Number of OpenSearch clients to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `3`                                                                                                                                        |
| `opensearch.client.affinity`                               | The affinity scheduling rules for OpenSearch clients.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                       |
| `opensearch.client.resources`                              | OpenSearch clients resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `opensearch.client.javaOpts`                               | OpenSearch clients configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `"-Xms512m -Xmx512m"`                                                                                                                      |
| `opensearch.client.service.type`                           | OpenSearch clients service type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `ClusterIP`                                                                                                                                |
| `opensearch.client.service.annotations`                    | OpenSearch clients service annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                                                                                                                                       |
| `opensearch.client.ingress.enabled`                        | Enable OpenSearch clients Ingress                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `false`                                                                                                                                    |
| `opensearch.client.ingress.annotations`                    | OpenSearch clients Ingress annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                                                                                                                                       |
| `opensearch.client.ingress.hosts`                          | OpenSearch clients Ingress Hostnames                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `opensearch.client.ingress.tls`                            | OpenSearch clients Ingress TLS configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `[]`                                                                                                                                       |
| `opensearch.client.ingress.labels`                         | OpenSearch clients Ingress labels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                                                                                                                                       |
| `opensearch.client.ingress.path`                           | OpenSearch clients Ingress path                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `/`                                                                                                                                        |
| `opensearch.client.livenessProbe`                          | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `opensearch.client.readinessProbe`                         | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `opensearch.client.startupProbe`                           | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `opensearch.client.podDisruptionBudget.enabled`            | If true, create a disruption budget for OpenSearch client                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                    |
| `opensearch.client.podDisruptionBudget.minAvailable`       | Minimum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                                                                                                                                        |
| `opensearch.client.podDisruptionBudget.maxUnavailable`     | Maximum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       |
| `opensearch.client.tolerations`                            | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       |
| `opensearch.client.nodeSelector`                           | Define which Nodes the client pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                       |
| `opensearch.client.podAnnotations`                         | OpenSearch client pods annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       |
| `opensearch.data.enabled`                                  | Enables the OpenSearch Data Node                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `true`                                                                                                                                     |
| `opensearch.data.dedicatedPod.enabled`                     | Enables dedicated `StatefulSet` for data. Otherwise master nodes as data storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    |
| `opensearch.data.replicas`                                 | Number of OpenSearch data nodes to spin up                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `3`                                                                                                                                        |
| `opensearch.data.affinity`                                 | The affinity scheduling rules for OpenSearch data pods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                       |
| `opensearch.data.resources`                                | OpenSearch data resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                                                                                                                                       |
| `opensearch.data.javaOpts`                                 | OpenSearch data configurable java options to pass to startup script                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `"-Xms512m -Xmx512m"`                                                                                                                      |
| `opensearch.data.persistence.enabled`                      | OpenSearch data enable persistent storage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                                                                                                     |
| `opensearch.data.persistence.existingClaim`                | OpenSearch data persistent existingClaim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | disabled by default, see `values.yaml`                                                                                                     |
| `opensearch.data.persistence.subPath`                      | OpenSearch data persistence subPath                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `opensearch.data.persistence.storageClass`                 | OpenSearch data storageClassName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | see `values.yaml` for defaults                                                                                                             |
| `opensearch.data.persistence.persistentVolumes`            | The list of OpenSearch data predefined persistent volumes. The number of PVs should be equal to number of data replicas. If `hostPath` PVs are used the `nodes` parameters is also should be specified.                                                                                                                                                                                                                                                                                                                                                           | [ ]                                                                                                                                        |
| `opensearch.data.persistence.nodes`                        | The list of Kubernetes node names to assign OpenSearch data pods. The number of nodes should be equal to number of data replicas. Should not be used with `storageClass` pod assignment.                                                                                                                                                                                                                                                                                                                                                                          | [ ]                                                                                                                                        |
| `opensearch.data.persistence.accessModes`                  | OpenSearch data persistence accessModes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `- ReadWriteOnce`                                                                                                                          |
| `opensearch.data.persistence.size`                         | OpenSearch data persistence size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `"5Gi"`                                                                                                                                    |
| `opensearch.data.persistence.annotations`                  | OpenSearch data persistent volume annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `opensearch.data.podDisruptionBudget.enabled`              | If true, create a disruption budget for OpenSearch data node                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `false`                                                                                                                                    |
| `opensearch.data.podDisruptionBudget.minAvailable`         | Minimum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                                                                                                                                        |
| `opensearch.data.podDisruptionBudget.maxUnavailable`       | Maximum number / percentage of pods that should remain scheduled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       |
| `opensearch.data.tolerations`                              | If specified, the OpenSearch client pod's tolerations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `[]`                                                                                                                                       |
| `opensearch.data.nodeSelector`                             | Define which Nodes the data pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                       |
| `opensearch.data.podAnnotations`                           | OpenSearch data pod annotations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                       |
| `opensearch.data.livenessProbe`                            | Configuration for the [livenessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                       |
| `opensearch.data.readinessProbe`                           | Configuration for the [readinessProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                             | `[]`                                                                                                                                       |
| `opensearch.data.startupProbe`                             | Configuration for the [startupProbe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `opensearch.data.updateStrategy`                           | The [updateStrategy](https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#updating-statefulsets) for the data `StatefulSet`.                                                                                                                                                                                                                                                                                                                                                                                                             | `RollingUpdate`                                                                                                                            |
| `opensearch.config`                                        | OpenSearch Configuration (`opensearch.yml`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       |
| `opensearch.loggingConfig`                                 | OpenSearch Logging Configuration (`logging.yml`)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | see `values.yaml` for defaults                                                                                                             |
| `opensearch.log4jConfig`                                   | OpenSearch log4j Configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `opensearch.transportKeyPassphrase.enabled`                | OpenSearch transport key passphrase required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `false`                                                                                                                                    |
| `opensearch.transportKeyPassphrase.passPhrase`             | OpenSearch transport key passphrase                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `opensearch.sslKeyPassphrase.enabled`                      | OpenSearch ssl key passphrase required                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `false`                                                                                                                                    |
| `opensearch.sslKeyPassphrase.passPhrase`                   | OpenSearch ssl key passphrase                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       |
| `opensearch.dockerImage`                                   | The docker image of OpenSearch                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-opensearch:master_latest`                                    |
| `opensearch.imagePullPolicy`                               | OpenSearch container image pull policy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `Always`                                                                                                                                   |
| `opensearch.initContainer.dockerImage`                     | The docker image of OpenSearch init container.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `artifactorycn.netcracker.com:17010/busybox:1.29.3`                                                                                        |
| `opensearch.serviceAccount.create`                         | Create a default service account for OpenSearch to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                     |
| `opensearch.serviceAccount.name`                           | Name for OpenSearch service account                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `opensearch.configDirectory`                               | Location of OpenSearch configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"/usr/share/opensearch/config"`                                                                                                           |
| `opensearch.maxMapCount`                                   | OpenSearch max_map_count                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `262144`                                                                                                                                   |
| `opensearch.extraEnvs`                                     | Extra environments variables to be passed to OpenSearch services                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `[]`                                                                                                                                       |
| `opensearch.extraVolumes`                                  | Array of extra volumes to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `[]`                                                                                                                                       |
| `opensearch.extraVolumeMounts`                             | Array of extra volume mounts to be added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                       |
| `opensearch.extraInitContainers`                           | Array of extra init containers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       |
| `opensearch.snapshots.enabled`                             | Create and mount persistent volume claim for snapshot repository.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `false`                                                                                                                                    |
| `opensearch.snapshots.persistentVolume`                    | The name of RWX Persistent Volume to store snapshots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `opensearch.snapshots.storageClass`                        | The name of shared storage class to store snapshots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `""`                                                                                                                                       |
| `opensearch.snapshots.persistentVolumeClaim`               | The name of RWX Persistent Volume Claim to store snapshots. If specified then no new PVC are created, OpenSearch pods use specified PVC.                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       |
| `opensearch.snapshots.size`                                | Snapshot volume size                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `"5Gi"`                                                                                                                                    |
| `opensearch.snapshots.s3.enabled`                          | Enables saving OpenSearch backups to S3 storage. **Note** Parameters `snapshots.persistentVolume` and `snapshots.storageClass` are not needed if S3 storage is enabled.                                                                                                                                                                                                                                                                                                                                                                                           | `false`                                                                                                                                    |
| `opensearch.snapshots.s3.pathStyleAccess`                  | Enables path style access for S3 storage.  **Note**: For Minio this parameter value must be `true`.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                    |
| `opensearch.snapshots.s3.url`                              | The URL of a S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       |
| `opensearch.snapshots.s3.bucket`                           | The bucket in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       |
| `opensearch.snapshots.s3.basePath`                         | The base path in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `"`                                                                                                                                        |
| `opensearch.snapshots.s3.region`                           | The region in the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       |
| `opensearch.snapshots.s3.keyId`                            | The key ID for the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `opensearch.snapshots.s3.keySecret`                        | The key secret for the S3 storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       |
| `podScheduler.enabled`                                     | Deploy custom kubernetes pod scheduler pod to assign OpenSearch pods to nodes with `hostPath` PV. Must be enabled if `persistentVolumes` and `nodes` are specified for master or data persistence.                                                                                                                                                                                                                                                                                                                                                                | `true`                                                                                                                                     |
| `podScheduler.dockerImage`                                 | The docker image for Pod Scheduler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `artifactorycn.netcracker.com:17010/bitnami/kubectl:1.20.6-debian-10-r17`                                                                  |
| `podScheduler.affinity`                                    | Pod Scheduler affinity rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                       |
| `podScheduler.nodeSelector`                                | Pod Scheduler node selector                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       |
| `podScheduler.resources`                                   | Pod Scheduler resource requests & limits                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `{}`                                                                                                                                       |
| `podScheduler.securityContext`                             | Pod Scheduler security context. Should be filed as `runAsUser: 1000` for non-root privileges environments.                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                                                                                                                                       |
| `monitoring.enabled`                                       | Enable the installation of OpenSearch monitoring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                     |
| `monitoring.dockerImage`                                   | The docker image of OpenSearch monitoring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_elasticsearch-telegraf:master_latest`                               |
| `monitoring.imagePullPolicy`                               | OpenSearch monitoring container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `Always`                                                                                                                                   |
| `monitoring.monitoringType`                                | The type of output plugin that is used for service monitoring. The possible values are `influxdb` and `prometheus`. If the value of this parameter is `influxdb`, you need to check and specify the parameters necessary for `InfluxDB` plugin (`smDbHost`, `smDbName`, `smDbUsername`, `smDbPassword`). Prometheus plugin does not require additional parameters for the configuration.                                                                                                                                                                          | `prometheus`                                                                                                                               |
| `monitoring.installDashboard`                              | Enable the installation of OpenSearch Grafana dashboard.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                                                                                                                                     |
| `monitoring.smDbHost`                                      | The host of the System Monitoring database. You must specify the parameter only if `monitoringType` parameter is equal to `influxdb`.                                                                                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                       |
| `monitoring.smDbName`                                      | The name of the database in System Monitoring. You must specify the parameter only if `monitoringType` parameter is equal to `influxdb`.                                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                       |
| `monitoring.smDbUsername`                                  | The name of the database user in System Monitoring. The parameter should be specified if `monitoringType` parameter is equal to `influxdb` and authentication is enabled in System Monitoring.                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `monitoring.smDbPassword`                                  | The password of the database user in System Monitoring. The parameter should be specified if `monitoringType` parameter is equal to `influxdb` and authentication is enabled in System Monitoring.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       |
| `monitoring.opensearchHost`                                | The host address of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `<fullnameOverride>`                                                                                                                       |
| `monitoring.opensearchPort`                                | The port of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `9200`                                                                                                                                     |
| `monitoring.opensearchDbaasAdapterHost`                    | The host of monitored OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `dbaas-<fullnameOverride>-adapter`                                                                                                         |
| `monitoring.opensearchDbaasAdapterPort`                    | The HTTP port of monitored OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `8080`                                                                                                                                     |
| `monitoring.opensearchExecPluginTimeout`                   | The timeout for OpenSearch exec Telegraf plugin.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `15s`                                                                                                                                      |
| `monitoring.resources.requests.cpu`                        | The minimum number of CPUs the monitoring container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `200m`                                                                                                                                     |
| `monitoring.resources.requests.memory`                     | The minimum amount of memory the monitoring container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                   | `256Mi`                                                                                                                                    |
| `monitoring.resources.limits.cpu`                          | The maximum number of CPUs the monitoring container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `200m`                                                                                                                                     |
| `monitoring.resources.limits.memory`                       | The maximum amount of memory the monitoring container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                      | `256Mi`                                                                                                                                    |
| `monitoring.nodeSelector`                                  | Define which Kubernetes nodes the OpenSearch monitoring pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `monitoring.tolerations`                                   | The list of toleration policies for OpenSearch monitoring pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                                                                                                                                       |
| `monitoring.affinity`                                      | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `monitoring.securityContext`                               | The pod-level security attributes and common container settings. For example, `runAsUser: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{runAsUser: 1000}`                                                                                                                        |
| `monitoring.monitoringCoreosGroup`                         | The `monitoringCoreosGroup` verbs for OpenSearch service operator role. The verbs are presented in role if the parameter value is set to `true`.                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                    |
| `dbaasAdapter.enabled`                                     | Enable the installation of OpenSearch DBaaS adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `false`                                                                                                                                    |
| `dbaasAdapter.dockerImage`                                 | The docker image of OpenSearch DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_dbaas_elasticsearch:master_latest`                                  |
| `dbaasAdapter.imagePullPolicy`                             | OpenSearch DBaaS Adapter container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `Always`                                                                                                                                   |
| `dbaasAdapter.dbaasAdapterAddress`                         | The address of OpenSearch DBaaS adapter, where aggregator should send requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `http://dbaas-<fullnameOverride>-adapter.<namespace>:8080`                                                                                 |
| `dbaasAdapter.dbaasUsername`                               | The name of the DBaaS adapter user, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `""`                                                                                                                                       |
| `dbaasAdapter.dbaasPassword`                               | The password of the DBaaS adapter user, either a new user or an existing one.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `""`                                                                                                                                       |
| `dbaasAdapter.dbaasAggregatorRegistrationAddress`          | The address of aggregator, which should register physical database. You need to specify this only if there are more than one aggregators installed in cloud and you need to choose one, or if the adapter is not in the same cloud, where aggregator is, or if default aggregator is not installed in the default "DBaaS" project. In case of default installation, you need to use the default address.                                                                                                                                                          | `http://dbaas-aggregator.dbaas:8080`                                                                                                       |
| `dbaasAdapter.dbaasAggregatorPhysicalDatabaseIdentifier`   | The unique ID of physical database, which adapter connects to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `<namespace>`                                                                                                                              |
| `dbaasAdapter.registrationAuthUsername`                    | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       |
| `dbaasAdapter.registrationAuthPassword`                    | The HTTP basic authorization for aggregator's registration API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                       |
| `dbaasAdapter.opensearchHost`                              | The host address of OpenSearch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `<fullnameOverride>`                                                                                                                       |
| `dbaasAdapter.opensearchPort`                              | The port of OpenSearch. If the OpenSearch URL does not contain port for example `https://opensearch`, the default protocol port should be specified: `80` for http and `443` for https.                                                                                                                                                                                                                                                                                                                                                                           | `9200`                                                                                                                                     |
| `dbaasAdapter.opensearchProtocol`                          | The protocol of communication with the OpenSearch. The allowed values are `http`, `https`. To access to `https` OpenSearch you need to install trusted TLS certificates for DBaaS Adapter.                                                                                                                                                                                                                                                                                                                                                                        | `http`                                                                                                                                     |
| `dbaasAdapter.opensearchRepo`                              | The name of snapshot repository in OpenSearch. The default behavior is to create a new repository with file storage location for each backup.                                                                                                                                                                                                                                                                                                                                                                                                                     | `snapshots`                                                                                                                                |
| `dbaasAdapter.opensearchRepoRoot`                          | The absolute path in OpenSearch file system where snapshot repositories for backups are created.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `/usr/share/opensearch`                                                                                                                    |
| `dbaasAdapter.opensearchClusterVersion`                    | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       |
| `dbaasAdapter.netcrackerOpensearchClusterVersion`          | The one of labels to set on the project, would be needed for clients to choose appropriate cluster. If not specified, empty string would be included in labels, client could not know which version is NetCracker wrapper around OpenSearch before requesting DBaaS to create index in it.                                                                                                                                                                                                                                                                        | `""`                                                                                                                                       |
| `dbaasAdapter.resources.requests.cpu`                      | The minimum number of CPUs the DBaaS adapter container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `200m`                                                                                                                                     |
| `dbaasAdapter.resources.requests.memory`                   | The minimum amount of memory the DBaaS adapter container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                | `32Mi`                                                                                                                                     |
| `dbaasAdapter.resources.limits.cpu`                        | The maximum number of CPUs the DBaaS adapter container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `200m`                                                                                                                                     |
| `dbaasAdapter.resources.limits.memory`                     | The maximum amount of memory the DBaaS adapter container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                   | `32Mi`                                                                                                                                     |
| `dbaasAdapter.nodeSelector`                                | Define which Kubernetes nodes the OpenSearch DBaaS adapter pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                                                                                                                                       |
| `dbaasAdapter.tolerations`                                 | The list of toleration policies for OpenSearch DBaaS adapter pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                                                                                                                                       |
| `dbaasAdapter.affinity`                                    | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `dbaasAdapter.securityContext`                             | The pod-level security attributes and common container settings. For example, `runAsUser: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                       |
| `curator.enabled`                                          | Enable the installation of OpenSearch curator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `false`                                                                                                                                    |
| `curator.dockerImage`                                      | The docker image of OpenSearch curator.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-elastic-curator:master_latest`                               |
| `curator.dockerIndicesCleanerImage`                        | The docker image of OpenSearch indices cleaner.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_docker-elastic-curator:master_latest_elasticsearch_indices_cleaner` |
| `curator.imagePullPolicy`                                  | OpenSearch curator container image pull policy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `Always`                                                                                                                                   |
| `curator.opensearchHost`                                   | The host address of OpenSearch, including the port.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `<fullnameOverride>:9200`                                                                                                                  |
| `curator.snapshotRepositoryName`                           | The name of snapshot repository in OpenSearch. This parameter determines **logical** name of folder where OpenSearch stores snapshots. This parameter is necessary for OpenSearch internal process to make snapshots. Do not use slash symbol `/` in this name. Please, pay attention that value of this parameter must be the same as the value of the similar parameter for OpenSearch.                                                                                                                                                                         | `snapshots`                                                                                                                                |
| `curator.backupSchedule`                                   | The schedule time in cron format (value must be within quotes). If this parameter is empty, the default schedule (`"0 0 * * *"`), defined in OpenSearch Curator configuration, is used. The value `0 0 * * *` means that snapshots are created everyday at 0:00.                                                                                                                                                                                                                                                                                                  | `""`                                                                                                                                       |
| `curator.evictionPolicy`                                   | The eviction policy. It is a comma-separated string of policies written as `$start_time/$interval`. This policy splits all backups older then `$start_time` to numerous time intervals `$interval` time long. Then it deletes all backups in every interval except the newest one. For example, `1d/7d` policy means "take all backups older then one day, split them in groups by 7-days interval, and leave only the newest". If this parameter is empty, the default eviction policy (`"0/1d,7d/delete"`) defined in OpenSearch Curator configuration is used. | `""`                                                                                                                                       |
| `curator.username`                                         | The username of the OpenSearch Curator API user. This parameter enables OpenSearch Curator authentication. If the parameter is empty, OpenSearch Curator is deployed with disabled authentication.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       |
| `curator.password`                                         | The password of the OpenSearch Curator API user. This parameter enables OpenSearch Curator authentication. If the parameter is empty, OpenSearch Curator is deployed with disabled authentication.                                                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                       |
| `curator.indicesCleanerSchedulerUnit`                      | The scheduler unit which specifies measure for value in `curator.indicesCleanerSchedulerUnitCount` parameter. Possible values are `day`, `days`, `friday`, `hour`, `hours`, `minute`, `minutes`, `monday`, `saturday`, `second`, `seconds`, `should_run`, `sunday`, `thursday`, `tuesday`, `wednesday`, `week`, `weeks`.                                                                                                                                                                                                                                          | `days`                                                                                                                                     |
| `curator.indicesCleanerSchedulerUnitCount`                 | The count value for `curator.indicesCleanerSchedulerUnit` parameter. It can be number (`2`) of units specified in `curator.indicesCleanerSchedulerUnit` parameter or particular time (`18:57`) to execute script. For example, `18:51` and `day` in `curator.indicesCleanerSchedulerUnit` parameter mean that cleaner script will be executed every day at `18:51` for current time zone.                                                                                                                                                                         | `1`                                                                                                                                        |
| `curator.indicesCleanerConfigurationKey`                   | The key for yaml key-value pair in `opensearch-indices-cleaner-configuration` config map. The value for this pair should be list of "configuration items". If you change this key in the config map, you should change it in the OpenSearch Curator deployment config.                                                                                                                                                                                                                                                                                            | `patterns_to_delete`                                                                                                                       |
| `curator.indicesCleanerConfiguration`                      | The value for yaml key-value pair in `opensearch-indices-cleaner-configuration` config map. The parameter should represent a list of "configuration items".                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `curator.resources.requests.cpu`                           | The minimum number of CPUs the curator container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `200m`                                                                                                                                     |
| `curator.resources.requests.memory`                        | The minimum amount of memory the curator container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                      | `256Mi`                                                                                                                                    |
| `curator.resources.limits.cpu`                             | The maximum number of CPUs the curator container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `200m`                                                                                                                                     |
| `curator.resources.limits.memory`                          | The maximum amount of memory the curator container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                         | `256Mi`                                                                                                                                    |
| `curator.nodeSelector`                                     | Define which Kubernetes nodes the OpenSearch curator pods are scheduled on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                       |
| `curator.tolerations`                                      | The list of toleration policies for OpenSearch curator pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                                                                                                                       |
| `curator.affinity`                                         | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `curator.securityContext`                                  | The pod-level security attributes and common container settings. For example, `fsGroup: 1000`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |
| `integrationTests.enabled`                                 | Enable the installation of OpenSearch integration tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `false`                                                                                                                                    |
| `integrationTests.dockerImage`                             | The docker image of OpenSearch Service integration tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `artifactorycn.netcracker.com:17008/product/prod.platform.elasticstack_opensearch-service:master_latest_integration-tests`                 |
| `integrationTests.tags`                                    | The tags combined with `AND`, `OR` and `NOT` operators that select test cases to run. You can use `smoke`, `authentication`, `backup`, `dbaas` and `ha` tags to run appropriate tests.                                                                                                                                                                                                                                                                                                                                                                            | `smoke`                                                                                                                                    |
| `integrationTests.opensearchPort`                          | The OpenSearch port                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `9200`                                                                                                                                     |
| `integrationTests.identityProviderUrl`                     | The URL of Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `integrationTests.identityProviderRegistrationToken`       | The registration token for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                                                                                                                                       |
| `integrationTests.identityProviderUsername`                | The name of the user for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                                                                                                                       |
| `integrationTests.identityProviderPassword`                | The password for Identity Provider. This parameter must be specified if you want to run integration tests with `authentication` tag.                                                                                                                                                                                                                                                                                                                                                                                                                              | `""`                                                                                                                                       |
| `integrationTests.opensearchDbaasAdapterPort`              | The DBaaS OpenSearch adapter port.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `8080`                                                                                                                                     |
| `integrationTests.opensearchCuratorPort`                   | The OpenSearch Curator port.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `8080`                                                                                                                                     |
| `integrationTests.prometheusUrl`                           | The URL (with schema and port) to Prometheus. For example, `http://prometheus.cloud.openshift.sdntest.example.com:80`. This parameter must be specified if you want to run integration tests with `prometheus` tag.                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                       |
| `integrationTests.resources.requests.cpu`                  | The minimum number of CPUs the container should use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `200m`                                                                                                                                     |
| `integrationTests.resources.requests.memory`               | The minimum amount of memory the container should use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                              | `256Mi`                                                                                                                                    |
| `integrationTests.resources.limits.cpu`                    | The maximum number of CPUs the container can use.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `400m`                                                                                                                                     |
| `integrationTests.resources.limits.memory`                 | The maximum amount of memory the container can use. The value can be specified with SI suffixes (E, P, T, G, M, K, m) or their power-of-two-equivalents (Ei, Pi, Ti, Gi, Mi, Ki).                                                                                                                                                                                                                                                                                                                                                                                 | `256Mi`                                                                                                                                    |
| `integrationTests.affinity`                                | The affinity scheduling rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                                                                                                                       |

## Samples

Base parameters example to deploy OpenSearch:

```
opensearch:
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
  securityContextCustom:
    fsGroup: 1000

  master:
    replicas: 3
    nodeSelector:
      role: compute
    javaOpts: "-Xms512m -Xmx512m"
    persistence:
      storageClass: local-storage
      size: 2Gi

  client:
    ingress:
      enabled: true
      hosts:
        - opensearch-opensearch-service.kubernetes.example.com
```

Extended example to deploy OpenSearch with Dashboards, OpenID Connect authentication, Predefined Persistent Volumes and Snapshot repository:

```
dashboards:
  enabled: true
  ingress:
    enabled: true
    hosts:
      - dashboards-opensearch-service.kubernetes.example.com

opensearch:
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
      oidc:
        openid_connect_url: "http://identity-management-security-services.example.kubernetes.com/.well-known/openid-configuration"

  master:
    replicas: 3
    resources:
      limits:
        cpu: 600m
        memory: 1024Mi
      requests:
        cpu: 200m
        memory: 1024Mi
    javaOpts: "-Xms512m -Xmx512m"
    persistence:
      persistentVolumes:
        - pv1
        - pv2
        - pv3
      nodes:
        - node1
        - node2
        - node3
      size: 2Gi

  client:
    ingress:
      enabled: true
      hosts:
        - opensearch-opensearch-service.kubernetes.example.com

  snapshots:
    enabled: true
    persistentVolume: "pv-snapshots"
    size: 2Gi

podScheduler:
  securityContext:
    runAsUser: 1000
  nodeSelector:
    role: compute

```

Base parameters example to deploy OpenSearch with arbiter nodes:

```
opensearch:
  master:
    enabled: true
    replicas: 2
    nodeSelector: 
      region: primary
    persistence:
      storageClass: "local-path"
    resources:
      limits:
        cpu: 500m
        memory: 2048Mi
  arbiter:
    enabled: true
    replicas: 1
    nodeSelector: 
      region: arbiter
    persistence:
      storageClass: "local-path"
    resources:
      limits:
        cpu: 300m
        memory: 1024Mi
```

You can add necessary parameters and sections to these examples to reach expected result.

# Deployment

## Manual Deployment

You can fill `values.yaml` witch necessary parameters or create different one `sample.yaml` and override only required fields (e.g., from [Samples](#samples)).

Then you can deploy release with `helm`:
```
$ helm install ${RELEASE_NAME} ./ -f sample.yaml -n ${NAMESPACE}
```

where:

* `${RELEASE_NAME}` is the release name of Helm Chart for OpenSearch service. For example, `opensearch-service`.
* `${NAMESPACE}` is the OpenShift/Kubernetes project/namespace to deploy OpenSearch service. For example, `opensearch-service`.

You can monitor the deployment process on the OpenShift/Kubernetes dashboard or using `kubectl` in the command line:

```
kubectl get pods
```

## Deployment via DP Deployer Job

To deploy via DP Deployer job, navigate to the Jenkins job `DP.Pub.Helm_deployer` and then click **Build with parameters**.

The job parameters are predefined and described as follows:

The `CLOUD_URL` parameter specifies the URL of the OpenShift/Kubernetes server. For example, `https://search.openshift.sdntest.example.com:8443`.

The `CLOUD_NAMESPACE` parameter specifies the name of the existing OpenShift project/Kubernetes namespace. For example, `opensearch-service`.

The `CLOUD_USER` parameter specifies the name of the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified with `CLOUD_PASSWORD` parameter if `CLOUD_TOKEN` parameter is not specified.

The `CLOUD_PASSWORD` parameter specifies the password for the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified with `CLOUD_USER` parameter if `CLOUD_TOKEN` parameter is not specified.

The `CLOUD_TOKEN` parameter specifies the token for the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.
The parameter should be specified if `CLOUD_USER` and `CLOUD_PASSWORD` parameters are not specified.

The `DESCRIPTOR_URL` parameter specifies the link to the OpenSearch Service Application
Manifest. The images for all components are taken from the manifest.

The `DEPLOYMENT_PARAMETERS` parameter specifies the yaml that contains necessary parameters for installation in yaml format.
You can find examples in [Samples](#samples) section.

The `DEPLOYMENT_MODE` parameter specifies the mode of the deployment.

The `ADDITIONAL_OPTIONS` parameter specifies the additional options for Helm install/upgrade commands. For example,
`--skip-crds` can be used in case of installation with restricted rights.

Click *Build*.

For information about:
* parameters, see [Parameters](#parameters)

## Deployment via Groovy Deployer Job

To deploy via Groovy Deployer job, navigate to the Jenkins job `groovy.deploy.v3` and then click **Build with parameters**.

The job parameters are predefined and described as follows:

The `PROJECT` parameter specifies the name of the existing OpenShift project/Kubernetes namespace. For example, `opensearch-service`.

The `OPENSHIFT_CREDENTIALS` parameter specifies the credentials of the user on behalf of whom the deployment process in OpenShift/Kubernetes starts.

The `DEPLOY_MODE` parameter specifies the mode of the deployment. The possible values are `Clean Install` and `Rolling Upgrade`.
The `Clean Install` mode removes everything from the project before deployment.

The `ARTIFACT_DESCRIPTOR_VERSION` parameter specifies the version of maven artifact in the format
`artifactId:artifactVersion`. For example, `opensearch-service:charts_v01`.
The images for all components are taken from the maven artifact.

The `CUSTOM_PARAMS` parameter specifies the list of necessary parameters for OpenSearch service installation.
All parameters should be divided by `;` and should not contain `"` in values.
You can find examples in [Samples](#samples) section.
Multiline sections can be filled with `'` as follows:
```
opensearch='
  securityConfig:
    authc:
      basic:
        username: "admin"
        password: "admin"
';
```

**Note**: You should always specify `DEPLOY_W_HELM=true;` as first parameter  and `ESCAPE_SEQUENCE=true;` as last to correct deploy Helm release.

Click *Build*.

For information about:
* parameters, see [Parameters](#parameters)

# Migration from Elasticsearch Service

## Migrate Persistent Volumes

1. Folder rights
   If previously Persistent Volumes `hostPath` folders were created with rights `100:101` it is necessary to change folders owner to `1000:1000`.

   If running as root user is allowed you need to add the following deploy parameters:
    ```
    opensearch:
      securityContextCustom:
        runAsUser: 1000
        runAsGroup: 1000
      fixMount:
        enabled: true
        securityContext:
          runAsUser: 0
    ```

   If running as root user is not allowed you need to change folders owner manually:
    ```
    chown 1000:1000 -R /data/pv1
    ```
   The same for the snapshot persistent volume.

2. Naming and Persistent Volume Claims

   If persistent volume claims exist and have naming `pvc-opensearch-0(1,2)` then you can use them without specifying storage class or persistent volume names.

   If you use `hostPath` predefined persistent volumes you need to specify `nodes` to assign pods:
    ```
    opensearch:
      master:
        persistence:
          nodes:
            - node-1
            - node-2
            - node-3
    ```

   If persistent volume claims have another naming you have to specify both `persistentVolumes` and `nodes` during deploy.

   If PV were created with `storageClass` you need to specify it without specifying `nodes`.

   Creating new PVC for existing utilized PV requires you to unbind Persistent Volumes from previous Claims. You can do it with command:
    ```
    kubectl patch pv pv1 -p '{"spec":{"claimRef": null}}'
    ``` 
   Old PVCs should be removed with removing deployments of previous installation.

## From OpenShift DVM Installation

1. Prepare environment and parameters

   Perform steps from [Migrate Persistent Volumes](#migrate-persistent-volumes).

   OpenShift's environment usually restricts running pods by security constraint policies.

   Generally you need to set the following annotations to your Project:

    ```
    openshift.io/sa.scc.uid-range: 1000/1001
    openshift.io/sa.scc.supplemental-groups: 1000/1001
    ```

   To automatically change persistent folder owner (`fixMount.enabled: true`) you need root privileges and have to set the following annotations:

    ```
    openshift.io/sa.scc.uid-range: 0/1001
    openshift.io/sa.scc.supplemental-groups: 0/1001
    ```

2. Delete previous deployments:

   Delete resources from previous installation. For example:

    ```
    kubectl delete all --all -n elasticsearch-cluster
    
    kubectl delete secret --all -n elasticsearch-cluster
   
    kubectl delete configmap --all -n elasticsearch-cluster
    ```

3. Install OpenSearch release.

## From Kubernetes Helm Chart Installation

1. Perform steps from [Migrate Persistent Volumes](#migrate-persistent-volumes).
2. Delete previous deployments

   Delete previous helm release. For example:
    ```
    helm uninstall elasticsearch-service -n elasticsearch-cluster
    ```

   Delete previous non-helm resources. For example:
    ```
    kubectl delete secret --all -n elasticsearch-cluster
   
    kubectl delete configmap --all -n elasticsearch-cluster
    ```
3. Install OpenSearch release.

# Custom Resource Definition

Custom resource definition versioning allows to have different incompatible CRD versions of the OpenSearch Service in several namespaces of OpenShift/Kubernetes. Each OpenSearch Service is placed in separate namespace and controlled by corresponding operator. Each operator reconciles the only version of the application, which it is compatible with.

## Apply New Custom Resource Definition Version

You can apply new custom resource definition version with versioning.

### Custom Resource Definition with Versioning

If the CRD is created manually, apply the new version of CRD with the following command:

```
kubectl apply -f charts/helm/opensearch-service/crds/crd.yaml
```

If the CRD is created using Helm, apply the new version of CRD with the following command:

```
kubectl replace -f charts/helm/opensearch-service/crds/crd.yaml
```

**Note**: For old versions of Kubernetes or OpenShift applying CRD may fail. For more information, refer to [CRD Creation Failed on OpenShift 3.11](../maintenance-guide/troubleshooting-guide/README.md#crd-creation-failed-on-openshift-311) section in the _Cloud Platform Troubleshooting Guide_.