build:
  env:
    type: application-integration
    version: openshift-dd-2
  networkRules: integration
  integration:
    multi_image_descriptor: true
    dmp_descriptor:
      version: '1.12'

publication:
  application-manifest:
    am-mf: application.mf
    am-zip: application.zip

deployment:
  availability_check: true
  availability:
    resource: Job
    conditions: Successful
    interval: 30
    max_tries: 60
    delay: 60
  mode: reinstall

integration:
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/disaster-recovery-daemon:main
    deploy-param: disasterRecoveryImage
    service-name: disaster-recovery-daemon
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/opensearch-integration-tests:main
    deploy-param: opensearchIntegrationTests
    service-name: opensearch-integration-tests
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/docker-opensearch:main
    deploy-param: dockerOpensearch
    service-name: docker-opensearch
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/opensearch-tls-init:main
    deploy-param: opensearchTlsInit
    service-name: opensearch-tls-init
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/elasticsearch-telegraf:main
    deploy-param: opensearchMonitoring
    service-name: opensearch-monitoring
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/dbaas-opensearch-adapter:main
    deploy-param: opensearchDbaasAdapter
    service-name: dbaas-opensearch-adapter
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/docker-elastic-curator:main
    deploy-param: opensearchCurator
    service-name: docker-elastic-curator
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/elasticsearch-indices-cleaner:main
    deploy-param: opensearchIndicesCleaner
    service-name: opensearch-indices-cleaner
  - type: image
    docker-image: artifactorycn.netcracker.com:17152/netcracker/deployment-status-provisioner:main
    deploy-param: deploymentStatusProvisioner
    service-name: deployment-status-provisioner
  - type: image
    docker-image: artifactorycn.netcracker.com:17064/opensearchproject/opensearch-dashboards:2.11.1
    deploy-param: dockerDashboards
  - type: image
    docker-image: artifactorycn.netcracker.com:17064/library/busybox:1.35.0
    deploy-param: busybox
  - type: image
    docker-image: artifactorycn.netcracker.com:17014/product/prod.platform.streaming_docker-kubectl:0.0.2_20230324-083045
    deploy-param: kubectl
  - type: scripts
    repo: PROD.Platform.ElasticStack/opensearch-service
    location: master
    alias: timestamp
    zip-name: migration-artifacts.zip
    name: migration-artifacts
    pre-deploy-entry-point: migration-artifacts/migration-artifacts.sh
  - type: scripts
    repo: PROD.Platform.ElasticStack/deployment-utils
    location: master
    alias: timestamp
    zip-name: devops-scripts.zip
    name: crd-upgrade
    pre-deploy-entry-point: crd-upgrade.sh
  - type: scripts
    repo: PROD.Platform.ElasticStack/deployment-utils
    location: master
    alias: latest
    zip-name: devops-scripts.zip
    name: privileged-pss
    pre-deploy-entry-point: privileged-pss.sh
